<!DOCTYPE html>
<html lang="en" x-data="{ sidebarOpen: false, darkMode: true }" :class="{ 'dark-mode': darkMode }">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>INEMI Dashboard</title>
    <!-- Favicon -->
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='logo/logo.png') }}">
    <link rel="shortcut icon" type="image/png" href="{{ url_for('static', filename='logo/logo.png') }}">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='logo/logo.png') }}">
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Alpine.js -->
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    
    <!-- Early declaration of toggleMobileNotifications to prevent ReferenceError -->
    <script>
    window.toggleMobileNotifications = function() {
        console.log('üîî toggleMobileNotifications called from base.html');
        console.log('üîî Window notification system exists:', !!window.notificationSystem);
        
        if (window.notificationSystem) {
            console.log('üîî Calling toggleNotifications()');
            window.notificationSystem.toggleNotifications();
        } else {
            console.log('üîî Notification system not ready, will be handled by notifications.js');
            // The notifications.js will override this function with proper implementation
        }
    };
    </script>
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --success-gradient: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);
            --warning-gradient: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
            --danger-gradient: linear-gradient(135deg, #ff9a9e 0%, #fecfef 100%);
            --bg-primary: #0a0a0f;
            --bg-secondary: #1a1a2e;
            --bg-tertiary: #16213e;
            --bg-card: rgba(26, 26, 46, 0.8);
            --text-primary: #ffffff;
            --text-secondary: #a0a0a0;
            --text-muted: #6b7280;
            --border-color: rgba(255, 255, 255, 0.1);
            --shadow-primary: 0 8px 32px rgba(0, 0, 0, 0.3);
            --shadow-secondary: 0 4px 16px rgba(0, 0, 0, 0.2);
            --glow-primary: 0 0 20px rgba(102, 126, 234, 0.5);
            --glow-secondary: 0 0 30px rgba(245, 87, 108, 0.4);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
            overflow-x: hidden;
            position: relative;
            /* Prevent iOS Safari from moving fixed elements */
            -webkit-overflow-scrolling: touch;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(245, 87, 108, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(79, 172, 254, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        /* iOS Safari specific fixes */
        @media screen and (-webkit-min-device-pixel-ratio: 0) {
            body {
                background-attachment: scroll !important;
                -webkit-background-attachment: scroll !important;
            }
            
            body::before {
                background-attachment: scroll !important;
                -webkit-background-attachment: scroll !important;
            }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 6px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-secondary);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-gradient);
            border-radius: 3px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--secondary-gradient);
        }

        /* Sidebar Styles */
        .sidebar {
            background: var(--bg-secondary);
            backdrop-filter: blur(20px);
            border-right: 1px solid var(--border-color);
            width: 280px;
            max-width: 280px;
            height: 100vh;
            position: fixed;
            left: 0;
            top: 0;
            z-index: 1000;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-y: auto;
            overflow-x: hidden;
            box-shadow: var(--shadow-primary);
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
        }

        .sidebar-header {
            padding: 1.5rem 1rem 1rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            overflow: visible;
        }

        .logo-container {
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        /* Mobile-only Close button in sidebar header */
        .sidebar-close-btn {
            display: none;
            align-items: center;
            justify-content: center;
            width: 44px;
            height: 44px;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.25), rgba(238, 90, 36, 0.2));
            border: 2px solid rgba(255, 107, 107, 0.5);
            border-radius: 14px;
            color: #ffffff;
            cursor: pointer;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 4px 16px rgba(255, 107, 107, 0.4),
                0 0 0 2px rgba(255, 107, 107, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            z-index: 10;
        }

        .sidebar-close-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sidebar-close-btn::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 0;
            height: 0;
            border-radius: 50%;
            background: rgba(255, 107, 107, 0.3);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: -1;
        }

        .sidebar-close-btn:hover::before,
        .sidebar-close-btn:active::before { 
            left: 100%; 
        }

        .sidebar-close-btn:hover::after,
        .sidebar-close-btn:active::after {
            width: 100%;
            height: 100%;
        }

        .sidebar-close-btn:hover,
        .sidebar-close-btn:active {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.4), rgba(238, 90, 36, 0.3));
            border-color: rgba(255, 107, 107, 0.7);
            color: #ffffff;
            transform: scale(1.1) rotate(90deg);
            box-shadow: 
                0 6px 24px rgba(255, 107, 107, 0.5),
                0 0 0 3px rgba(255, 107, 107, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .sidebar-close-btn:active {
            transform: scale(0.95) rotate(90deg);
        }

        .sidebar-close-btn i { 
            font-size: 1.3rem; 
            position: relative; 
            z-index: 2;
            font-weight: 700;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
        }

        .logo-image {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            object-fit: cover;
            box-shadow: var(--glow-primary);
        }

        .logo-text {
            font-family: 'Orbitron', monospace;
            font-size: 1.25rem;
            font-weight: 900;
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            letter-spacing: 1.5px;
        }

        .user-profile {
            padding: 1.25rem 1rem;
            display: flex;
            align-items: flex-start;
            gap: 0.875rem;
            border-bottom: 1px solid var(--border-color);
            min-height: 80px;
            width: 100%;
            max-width: 100%;
            overflow: hidden;
            box-sizing: border-box;
        }

        .user-avatar {
            width: 52px;
            height: 52px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid transparent;
            background: var(--primary-gradient);
            padding: 2px;
            box-shadow: var(--glow-primary);
            flex-shrink: 0;
        }

        .user-info {
            flex: 1;
            min-width: 0;
            max-width: 100%;
            display: flex;
            flex-direction: column;
            gap: 0.375rem;
            overflow: hidden;
            box-sizing: border-box;
        }

        .user-name-row {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            width: 100%;
            min-width: 0;
            max-width: 100%;
            overflow: hidden;
            box-sizing: border-box;
        }

        .user-name-wrapper {
            flex: 1;
            min-width: 0;
            max-width: 100%;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            overflow: hidden;
            box-sizing: border-box;
        }

        .user-name-text {
            font-size: 1rem;
            font-weight: 600;
            margin: 0;
            color: var(--text-primary);
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
            flex: 1;
            min-width: 0;
            max-width: 100%;
        }

        .user-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            flex-shrink: 0;
            min-width: fit-content;
        }

        .logout-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 38px;
            height: 38px;
            min-width: 38px;
            min-height: 38px;
            background: rgba(255, 107, 107, 0.12);
            border: 2px solid rgba(255, 107, 107, 0.35);
            border-radius: 10px;
            color: #ff6b6b;
            text-decoration: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            flex-shrink: 0;
        }

        .logout-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 107, 107, 0.25), transparent);
            transition: left 0.5s;
        }

        .logout-btn:hover::before {
            left: 100%;
        }

        .logout-btn:hover {
            background: rgba(255, 107, 107, 0.25);
            border-color: #ff5252;
            color: #ff5252;
            transform: translateY(-2px) scale(1.05);
            box-shadow: 0 6px 16px rgba(255, 107, 107, 0.4);
        }

        .logout-btn:active {
            transform: translateY(0) scale(1);
        }

        .logout-btn i {
            font-size: 1.1rem;
            z-index: 1;
            position: relative;
        }

        .user-info h4 {
            font-size: 1rem;
            font-weight: 600;
            margin: 0;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            width: 100%;
            min-width: 0;
        }

        .credits-badge {
            background: var(--success-gradient);
            color: var(--text-primary);
            padding: 0.25rem 0.65rem;
            border-radius: 16px;
            font-size: 0.65rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 0.2rem;
            flex-shrink: 0;
            white-space: nowrap;
            max-width: fit-content;
            box-sizing: border-box;
        }

        .user-role {
            font-size: 0.75rem;
            color: var(--text-secondary);
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 500;
        }

        /* Notification Bell in Sidebar */
        .notification-bell-sidebar {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            min-width: fit-content;
        }

        .notification-icon-sidebar {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: var(--primary-gradient);
            border-radius: 50%;
            color: white;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(168, 85, 247, 0.3);
            pointer-events: auto;
            z-index: 10;
        }

        .notification-icon-sidebar:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(168, 85, 247, 0.5);
        }

        .notification-icon-sidebar i {
            font-size: 1.1rem;
        }

        .notification-badge-sidebar {
            position: absolute;
            top: -5px;
            right: -5px;
            background: #ff4757;
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
            font-weight: 600;
            border: 2px solid var(--bg-secondary);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 71, 87, 0.7);
            }
            70% {
                transform: scale(1.05);
                box-shadow: 0 0 0 10px rgba(255, 71, 87, 0);
            }
            100% {
                transform: scale(1);
                box-shadow: 0 0 0 0 rgba(255, 71, 87, 0);
            }
        }

        /* Notification Dropdown Styles */
        .notification-dropdown {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        .notification-header {
            padding: 1.5rem 1.5rem 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color, #333);
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: var(--bg-secondary, #1a1a2e);
        }

        .notification-header h3 {
            margin: 0;
            color: var(--text-primary, #fff);
            font-size: 1.25rem;
            font-weight: 600;
            background: var(--primary-gradient, linear-gradient(135deg, #a855f7, #ec4899));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .notification-header-actions {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .notification-header button {
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s ease;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .mark-all-read {
            background: var(--primary-gradient, linear-gradient(135deg, #a855f7, #ec4899));
            color: white;
            padding: 0.5rem 1rem;
            box-shadow: 0 2px 8px rgba(168, 85, 247, 0.3);
        }

        .mark-all-read:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(168, 85, 247, 0.4);
        }

        .close-notifications {
            background: #dc3545;
            color: white;
            padding: 0.5rem;
            width: 36px;
            height: 36px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-notifications:hover {
            background: #c82333;
            transform: translateY(-1px);
        }

        .notification-list {
            max-height: 60vh;
            overflow-y: auto;
            padding: 0;
        }

        .notification-list::-webkit-scrollbar {
            width: 4px;
        }

        .notification-list::-webkit-scrollbar-track {
            background: var(--bg-primary, #0f0f23);
        }

        .notification-list::-webkit-scrollbar-thumb {
            background: var(--primary-gradient, linear-gradient(135deg, #a855f7, #ec4899));
            border-radius: 2px;
        }


        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .notification-item {
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border-color, #333);
            display: flex;
            align-items: flex-start;
            gap: 1rem;
            transition: background-color 0.2s ease;
        }

        .notification-item:hover {
            background: rgba(168, 85, 247, 0.05);
        }

        .notification-item:last-child {
            border-bottom: none;
        }

        .notification-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            flex-shrink: 0;
        }

        .notification-content {
            flex: 1;
            min-width: 0;
        }

        .notification-text {
            color: var(--text-primary, #fff);
            font-size: 0.875rem;
            line-height: 1.4;
            margin-bottom: 0.25rem;
        }

        .notification-time {
            color: var(--text-secondary, #888);
            font-size: 0.75rem;
        }

        .notification-footer {
            padding: 1rem 1.5rem;
            border-top: 1px solid var(--border-color, #333);
            text-align: center;
            background: var(--bg-secondary, #1a1a2e);
        }

        .view-all-notifications {
            color: var(--primary-color, #a855f7);
            text-decoration: none;
            font-weight: 500;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            transition: all 0.2s ease;
        }

        .view-all-notifications:hover {
            background: rgba(168, 85, 247, 0.1);
            color: var(--primary-color, #a855f7);
            transform: translateY(-1px);
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            .notification-dropdown {
                position: fixed !important;
                top: 50% !important;
                left: 50% !important;
                transform: translate(-50%, -50%) !important;
                width: 95% !important;
                max-width: none !important;
                margin: 0 !important;
                max-height: 90vh !important;
                border-radius: 20px !important;
                z-index: 10000 !important;
            }
            
            /* Force center positioning for mobile */
            #notification-dropdown {
                position: fixed !important;
                top: 50% !important;
                left: 50% !important;
                transform: translate(-50%, -50%) !important;
                width: 95% !important;
                max-width: none !important;
                margin: 0 !important;
                z-index: 10000 !important;
            }

            .notification-header {
                padding: 1.25rem 1rem 1rem 1rem;
                border-radius: 20px 20px 0 0;
            }

            .notification-header h3 {
                font-size: 1.1rem;
            }

            .notification-header-actions {
                gap: 0.5rem;
            }

            .mark-all-read {
                padding: 0.4rem 0.8rem !important;
                font-size: 0.8rem !important;
            }

            .mark-all-read span {
                display: none;
            }

            .close-notifications {
                width: 32px !important;
                height: 32px !important;
                padding: 0.4rem !important;
            }

            .notification-item {
                padding: 1rem;
                border-radius: 0;
            }

            .notification-avatar {
                width: 36px;
                height: 36px;
            }

            .notification-text {
                font-size: 0.85rem;
                line-height: 1.4;
            }

            .notification-time {
                font-size: 0.7rem !important;
            }

            .notification-footer {
                padding: 1rem;
                border-radius: 0 0 20px 20px;
            }

            .view-all-notifications {
                padding: 0.75rem 1rem !important;
                font-size: 0.9rem !important;
            }
        }

        /* Extra small mobile */
        @media (max-width: 480px) {
            .notification-dropdown {
                width: 98% !important;
                max-height: 95vh !important;
            }
            
            #notification-dropdown {
                width: 98% !important;
                max-height: 95vh !important;
            }

            .notification-header {
                padding: 1rem 0.75rem 0.75rem 0.75rem;
            }

            .notification-item {
                padding: 0.75rem;
            }

            .notification-avatar {
                width: 32px;
                height: 32px;
            }

            .notification-text {
                font-size: 0.8rem;
            }
        }
        
        /* Prevent notification from moving */
        .notification-dropdown,
        #notification-dropdown {
            will-change: transform, opacity !important;
            backface-visibility: hidden !important;
            -webkit-backface-visibility: hidden !important;
        }
        
        /* Loading animation */
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        
        /* Ensure notification stays visible on mobile */
        @media (max-width: 768px) {
            .notification-dropdown,
            #notification-dropdown {
                position: fixed !important;
                top: 50% !important;
                left: 50% !important;
                transform: translate(-50%, -50%) !important;
                width: 95% !important;
                max-width: none !important;
                margin: 0 !important;
                z-index: 10000 !important;
                visibility: hidden !important;
                display: none !important;
            }
            
            .notification-overlay {
                position: fixed !important;
                top: 0 !important;
                left: 0 !important;
                width: 100% !important;
                height: 100% !important;
                z-index: 9999 !important;
                visibility: hidden !important;
                display: none !important;
            }
        }

        .nav-menu {
            padding: 1.25rem 1rem;
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .nav-item {
            margin-bottom: 0;
        }

        .nav-link {
            display: flex;
            align-items: center;
            gap: 0.875rem;
            padding: 0.95rem 1.125rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 12px;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid transparent;
            backdrop-filter: blur(10px);
            min-height: 48px;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(76, 126, 255, 0.15), rgba(93, 95, 239, 0.15));
            transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: -1;
        }

        .nav-link::after {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%) scaleY(0);
            width: 3px;
            height: 0;
            background: linear-gradient(180deg, var(--accent-neon), rgba(93, 95, 239, 0.8));
            border-radius: 0 3px 3px 0;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-link:hover::before,
        .nav-link.active::before {
            left: 0;
        }

        .nav-link:hover::after,
        .nav-link.active::after {
            transform: translateY(-50%) scaleY(1);
            height: 60%;
        }

        .nav-link:hover,
        .nav-link.active {
            color: var(--text-primary);
            transform: translateX(6px);
            box-shadow: 
                0 4px 16px rgba(76, 126, 255, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border-color: rgba(76, 126, 255, 0.3);
            background: rgba(76, 126, 255, 0.08);
        }

        .nav-link.active {
            background: linear-gradient(135deg, rgba(76, 126, 255, 0.12), rgba(93, 95, 239, 0.08));
            border-color: rgba(76, 126, 255, 0.4);
            box-shadow: 
                0 6px 20px rgba(76, 126, 255, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        .nav-icon {
            font-size: 1.1rem;
            width: 22px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .nav-link:hover .nav-icon,
        .nav-link.active .nav-icon {
            transform: scale(1.1);
        }

        .nav-text {
            font-weight: 500;
            font-size: 0.85rem;
        }

        /* AI Tools Section */
        .ai-tools-section {
            margin-top: auto;
            padding: 1.25rem 1rem;
            border-top: 1px solid rgba(76, 126, 255, 0.15);
            background: linear-gradient(180deg, transparent 0%, rgba(76, 126, 255, 0.03) 100%);
        }

        .ai-tools-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            padding: 0.625rem 0.875rem;
            background: rgba(76, 126, 255, 0.06);
            border-radius: 10px;
            border: 1px solid rgba(76, 126, 255, 0.12);
        }

        .ai-tools-header i {
            font-size: 1.1rem;
            color: var(--accent-neon);
            filter: drop-shadow(0 0 8px rgba(76, 126, 255, 0.5));
        }

        .ai-tools-title {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 1px;
            background: linear-gradient(135deg, var(--accent-neon), rgba(93, 95, 239, 0.9));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .ai-tools-menu {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .ai-tool-item {
            display: flex;
            align-items: center;
            gap: 0.875rem;
            padding: 0.875rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.85rem;
            position: relative;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid transparent;
            backdrop-filter: blur(8px);
            min-height: 44px;
        }

        .ai-tool-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(76, 126, 255, 0.12), rgba(93, 95, 239, 0.08));
            transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: -1;
        }

        .ai-tool-item:hover::before {
            left: 0;
        }

        .ai-tool-item:hover {
            color: var(--text-primary);
            transform: translateX(5px);
            border-color: rgba(76, 126, 255, 0.25);
            box-shadow: 
                0 4px 12px rgba(76, 126, 255, 0.15),
                inset 0 1px 0 rgba(255, 255, 255, 0.08);
        }

        .ai-tool-item i {
            font-size: 1rem;
            width: 18px;
            text-align: center;
            transition: transform 0.3s ease;
        }

        .ai-tool-item:hover i {
            transform: scale(1.15);
        }

        .ai-tool-text {
            flex: 1;
            font-weight: 500;
        }

        .ai-tool-badge {
            font-size: 0.65rem;
            padding: 0.2rem 0.4rem;
            border-radius: 4px;
            background: var(--primary-gradient);
            color: white;
            font-weight: 600;
        }

        .ai-tool-badge.hot {
            background: linear-gradient(135deg, #ff4d4d, #ff0000);
            box-shadow: 0 0 12px rgba(255, 77, 77, 0.35);
        }

        .ai-tool-badge.new {
            background: var(--success-gradient);
        }

        /* Chat Section */
        .chat-section {
            padding: 1.25rem 1rem;
            border-top: 1px solid rgba(76, 126, 255, 0.15);
            background: linear-gradient(180deg, transparent 0%, rgba(79, 172, 254, 0.02) 100%);
        }

        .chat-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1rem;
            padding: 0.625rem 0.875rem;
            background: rgba(79, 172, 254, 0.06);
            border-radius: 10px;
            border: 1px solid rgba(79, 172, 254, 0.12);
        }

        .chat-header i {
            font-size: 1.1rem;
            color: var(--accent-color);
            filter: drop-shadow(0 0 8px rgba(79, 172, 254, 0.5));
        }

        .chat-title {
            font-size: 0.85rem;
            font-weight: 700;
            color: var(--text-primary);
            text-transform: uppercase;
            letter-spacing: 1px;
            background: linear-gradient(135deg, var(--accent-color), rgba(79, 172, 254, 0.9));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .chat-menu {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .chat-item {
            display: flex;
            align-items: center;
            gap: 0.875rem;
            padding: 0.875rem 1rem;
            color: var(--text-secondary);
            text-decoration: none;
            border-radius: 10px;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            font-size: 0.85rem;
            position: relative;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid transparent;
            backdrop-filter: blur(8px);
            min-height: 44px;
            overflow: hidden;
        }

        .chat-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: rgba(79, 172, 254, 0.1);
            transition: left 0.3s ease;
            z-index: -1;
        }

        .chat-item:hover::before {
            left: 0;
        }

        .chat-item:hover {
            color: var(--text-primary);
            transform: translateX(4px);
        }

        .chat-item i {
            font-size: 0.9rem;
            width: 16px;
            text-align: center;
        }

        .chat-text {
            flex: 1;
            font-weight: 500;
        }

          .admin-badge {
    position: absolute;
    top: 50%;
    right: 8px;
    transform: translateY(-50%);
    background: linear-gradient(135deg, #ff6b6b, #ee5a24);
    padding: 0.2rem 0.5rem;
    border-radius: 12px;
    font-size: 0.65rem;
            font-weight: 700;
    color: white;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);
    border: 1px solid rgba(255, 255, 255, 0.3);
    animation: badgeGlow 1.5s ease-in-out infinite alternate;
    line-height: 1;
    display: flex;
    align-items: center;
    justify-content: center;
    min-height: 18px;
  }

  /* Notification System Styles */
  .notification-bell {
    position: relative;
    cursor: pointer;
    margin-left: 1rem;
  }

  .notification-icon {
    position: relative;
            display: flex;
            align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background: rgba(99, 102, 241, 0.1);
    transition: all 0.3s ease;
  }

  .notification-icon:hover {
    background: rgba(99, 102, 241, 0.2);
    transform: scale(1.1);
  }

  .notification-icon i {
    font-size: 1.2rem;
    color: #e2e8f0;
  }

  .notification-badge {
    position: absolute;
    top: -5px;
    right: -5px;
    background: linear-gradient(135deg, #ff6b6b, #ee5a24);
    color: white;
    font-size: 0.7rem;
    font-weight: 700;
    padding: 2px 6px;
    border-radius: 10px;
    border: 2px solid #1a1a2e;
    min-width: 18px;
    text-align: center;
    display: none;
    animation: pulse 2s infinite;
  }

  .notification-overlay {
    position: fixed;
            top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 999;
    display: none;
    cursor: pointer;
  }

  .notification-dropdown {
    position: fixed;
    top: 80px;
    right: 20px;
    width: 400px;
    max-height: 600px;
    background: #1a1a2e;
    border-radius: 20px;
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
    border: 1px solid rgba(99, 102, 241, 0.3);
    backdrop-filter: blur(20px);
    z-index: 1000;
    display: none;
    overflow: hidden;
    animation: slideInDown 0.3s ease;
  }

  @keyframes slideInDown {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .notification-header {
            display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.2rem 1.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(99, 102, 241, 0.05);
  }

  .notification-header h3 {
    color: #fff;
    font-size: 1.2rem;
    font-weight: 800;
    margin: 0;
            display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .notification-header h3::before {
    content: 'üîî';
    font-size: 1.1rem;
  }

  .notification-header-actions {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .close-notifications {
    background: rgba(255, 255, 255, 0.1);
            border: none;
    color: #e2e8f0;
    padding: 0.5rem;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: none;
  }

  .close-notifications:hover {
    background: rgba(255, 255, 255, 0.2);
            color: #fff;
  }

  .mark-all-read {
    background: linear-gradient(135deg, #6366f1, #ec4899);
    color: white;
    border: none;
    padding: 0.4rem 0.8rem;
    border-radius: 8px;
    font-size: 0.8rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
  }

  .mark-all-read:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(99, 102, 241, 0.4);
  }

  .notification-list {
    max-height: 350px;
    overflow-y: auto;
    padding: 0.5rem 0;
  }

  .notification-item {
            display: flex;
            align-items: flex-start;
    padding: 1rem 1.5rem;
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
  }

  .notification-item:hover {
    background: rgba(99, 102, 241, 0.08);
    transform: translateX(5px);
  }

  .notification-item.unread {
    background: rgba(99, 102, 241, 0.1);
    border-left: 3px solid #6366f1;
  }

  .notification-item.unread:hover {
    background: rgba(99, 102, 241, 0.15);
  }

  .notification-item:last-child {
    border-bottom: none;
  }

  .notification-avatar {
    width: 45px;
    height: 45px;
    border-radius: 50%;
    overflow: hidden;
    margin-right: 1rem;
    flex-shrink: 0;
    border: 2px solid rgba(99, 102, 241, 0.3);
    transition: all 0.3s ease;
  }

  .notification-avatar:hover {
    border-color: #6366f1;
    transform: scale(1.05);
  }

  .notification-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
  }

  .notification-content {
    flex: 1;
            min-width: 0;
        }

  .notification-text {
    color: #e2e8f0;
    font-size: 0.95rem;
    line-height: 1.5;
    margin-bottom: 0.4rem;
  }

  .notification-text strong {
    color: #a78bfa;
            font-weight: 700;
  }

  .notification-text .notification-type-icon {
    display: inline-block;
    margin-left: 0.3rem;
    font-size: 0.8rem;
  }

  .notification-time {
    color: #94a3b8;
    font-size: 0.85rem;
            display: flex;
    align-items: center;
    gap: 0.3rem;
  }

  .notification-time::before {
    content: 'üïê';
    font-size: 0.7rem;
  }

  .notification-status {
    display: flex;
    align-items: center;
    margin-left: 0.5rem;
  }

  .unread-dot {
    width: 8px;
    height: 8px;
    background: linear-gradient(135deg, #ff6b6b, #ee5a24);
    border-radius: 50%;
    animation: pulse 2s infinite;
  }

  .notification-footer {
    padding: 0.8rem 1.2rem;
    border-top: 1px solid rgba(99, 102, 241, 0.1);
    text-align: center;
  }

  .view-all-notifications {
    color: #a78bfa;
    text-decoration: none;
    font-size: 0.9rem;
            font-weight: 600;
    transition: color 0.3s ease;
  }

  .view-all-notifications:hover {
    color: #c4b5fd;
  }

  .no-notifications {
    text-align: center;
    padding: 2rem 1rem;
            color: #94a3b8;
  }

  .no-notifications i {
    font-size: 2rem;
    margin-bottom: 0.5rem;
    opacity: 0.5;
  }


  /* Toast Notifications */
  #toast-container {
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 9999;
            display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .notification-toast {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: linear-gradient(135deg, #1a1a2e, #16213e);
    color: white;
    padding: 1rem 1.2rem;
    border-radius: 12px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(99, 102, 241, 0.2);
    backdrop-filter: blur(10px);
    min-width: 300px;
    max-width: 400px;
    animation: slideInRight 0.3s ease;
  }

  .notification-toast.success {
    border-color: rgba(34, 197, 94, 0.3);
  }

  .notification-toast.error {
    border-color: rgba(239, 68, 68, 0.3);
  }

  .notification-toast.warning {
    border-color: rgba(245, 158, 11, 0.3);
  }

  .toast-content {
    display: flex;
    align-items: center;
    gap: 0.5rem;
  }

  .toast-content i {
    font-size: 1.1rem;
  }

  .toast-close {
    background: none;
    border: none;
    color: #94a3b8;
    cursor: pointer;
    padding: 0.2rem;
    border-radius: 4px;
    transition: all 0.3s ease;
  }

  .toast-close:hover {
    color: #e2e8f0;
    background: rgba(255, 255, 255, 0.1);
  }

  /* Animations */
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }

  @keyframes spin {
    from { transform: rotate(0deg); }
    to { transform: rotate(360deg); }
  }

  @keyframes slideInRight {
    from {
      transform: translateX(100%);
      opacity: 0;
    }
    to {
      transform: translateX(0);
      opacity: 1;
    }
  }

  @keyframes slideOutRight {
    from {
      transform: translateX(0);
      opacity: 1;
    }
    to {
      transform: translateX(100%);
      opacity: 0;
    }
  }

  /* Sidebar Notification Bell */
  .notification-bell-sidebar {
            display: flex;
            align-items: center;
            gap: 0.8rem;
    cursor: pointer;
    position: relative;
    padding: 0.5rem 0;
  }

  .notification-icon-sidebar {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 40px;
    height: 40px;
            border-radius: 50%;
    background: rgba(99, 102, 241, 0.1);
    transition: all 0.3s ease;
  }

  .notification-icon-sidebar:hover {
    background: rgba(99, 102, 241, 0.2);
    transform: scale(1.1);
  }

  .notification-badge-sidebar {
    position: absolute;
    top: -5px;
    right: -5px;
    background: linear-gradient(135deg, #ff6b6b, #ee5a24);
    color: white;
    font-size: 0.7rem;
    font-weight: 700;
    padding: 2px 6px;
    border-radius: 10px;
    border: 2px solid #1a1a2e;
    min-width: 18px;
    text-align: center;
    display: none;
    animation: pulse 2s infinite;
  }



  /* Header Notification Bell (next to Upgrade button) */
  .notification-bell-header {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
    width: 36px;
    height: 36px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 50%;
    cursor: pointer;
    transition: all 0.3s ease;
    margin-right: 10px;
  }

  .notification-bell-header:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: scale(1.05);
  }

  .notification-icon-header {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .notification-icon-header i {
    color: #e2e8f0;
    font-size: 1.1rem;
    transition: all 0.3s ease;
  }

  .notification-bell-header:hover .notification-icon-header i {
    color: #fff;
  }

  .notification-badge-header {
    position: absolute;
    top: -8px;
    right: -8px;
    background: linear-gradient(135deg, #ff6b6b, #ee5a24);
    color: white;
    font-size: 0.65rem;
    font-weight: 700;
    padding: 2px 5px;
    border-radius: 8px;
    min-width: 16px;
    text-align: center;
    display: none;
    animation: pulse 2s infinite;
    border: 2px solid #1a1a2e;
  }

  /* Responsive */
  @media (max-width: 768px) {
    .notification-dropdown {
                position: fixed;
      top: 0;
                left: 0;
      right: 0;
                bottom: 0;
      width: 100%;
      height: 100%;
      max-height: 100vh;
      border-radius: 0;
      transform: none;
      animation: slideInUp 0.3s ease;
      z-index: 1001;
    }

    @keyframes slideInUp {
      from {
        opacity: 0;
        transform: translateY(100%);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .notification-overlay {
      z-index: 1000;
    }

    .notification-header {
      padding: 1rem 1.2rem;
      position: sticky;
      top: 0;
      background: #1a1a2e;
      z-index: 2;
    }

    .notification-header h3 {
      font-size: 1.1rem;
    }

    .close-notifications {
      display: block;
    }

    .notification-list {
      max-height: calc(100vh - 140px);
      overflow-y: auto;
    }

    .notification-item {
      padding: 0.8rem 1.2rem;
    }

    .notification-avatar {
      width: 40px;
      height: 40px;
      margin-right: 0.8rem;
    }

    .notification-text {
      font-size: 0.9rem;
    }

    .notification-footer {
      position: sticky;
      bottom: 0;
      background: #1a1a2e;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .notification-toast {
      min-width: 280px;
      max-width: 320px;
    }
  }

  @media (max-width: 480px) {
    .notification-item {
      padding: 0.7rem 1rem;
    }

    .notification-avatar {
      width: 35px;
      height: 35px;
      margin-right: 0.7rem;
    }

    .notification-text {
      font-size: 0.85rem;
    }

    .notification-time {
      font-size: 0.8rem;
    }
  }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            min-height: 100vh;
            transition: margin-left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            /* Prevent transform from affecting fixed children on iOS */
            -webkit-transform: none;
            transform: none;
        }

        .content-wrapper {
            padding: 2rem;
            /* Prevent transform from affecting fixed children on iOS */
            -webkit-transform: none;
            transform: none;
        }

        /* Mobile Navigation */
        .mobile-nav {
            display: none;
            position: fixed !important;
            bottom: 0 !important;
            left: 0 !important;
            right: 0 !important;
            width: 100% !important;
            max-width: 100vw !important;
            background: linear-gradient(180deg, rgba(14, 11, 44, 0.95) 0%, rgba(14, 11, 44, 0.98) 100%);
            backdrop-filter: blur(30px);
            -webkit-backdrop-filter: blur(30px);
            border-top: 1px solid rgba(76, 126, 255, 0.2);
            padding: 0.75rem 1rem;
            padding-bottom: calc(0.75rem + env(safe-area-inset-bottom, 0px)) !important;
            z-index: 99999 !important;
            box-shadow: 
                0 -4px 30px rgba(0, 0, 0, 0.4),
                0 -2px 10px rgba(76, 126, 255, 0.1);
            min-height: 75px;
            margin: 0 !important;
            /* iOS Safari fix for position:fixed - Force hardware acceleration */
            -webkit-transform: translate3d(0, 0, 0) !important;
            transform: translate3d(0, 0, 0) !important;
            -webkit-backface-visibility: hidden !important;
            backface-visibility: hidden !important;
            /* Prevent scrolling issues on iOS */
            -webkit-overflow-scrolling: touch;
            will-change: transform;
            /* Ensure it stays at bottom viewport */
            top: auto !important;
        }

        /* Mobile Menu Button */
        .mobile-menu-btn {
            background: var(--primary-gradient) !important;
            border: none !important;
            color: white !important;
            border-radius: 12px !important;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
            box-shadow: var(--glow-primary) !important;
        }

        .mobile-menu-btn:hover {
            transform: translateY(-2px) scale(1.05) !important;
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.5) !important;
        }

        .mobile-menu-btn:active {
            transform: translateY(0) scale(0.95) !important;
        }

        /* Mobile Navbar Modal Styles */
        .mobile-navbar-modal {
            background: var(--bg-primary) !important;
            border: none !important;
            border-radius: 0 !important;
            min-height: 100vh !important;
            color: var(--text-primary) !important;
        }

        .mobile-navbar-header {
            background: var(--bg-secondary) !important;
            border-bottom: 1px solid var(--border-color) !important;
            padding: 1.5rem 2rem !important;
            display: flex !important;
            justify-content: space-between !important;
            align-items: center !important;
            position: relative !important;
            overflow: visible !important;
        }
        
        /* Ensure close button is visible and positioned correctly */
        .mobile-navbar-header .btn-close {
            position: fixed !important;
            right: 24px !important;
            top: 16px !important;
            z-index: 99999 !important;
        }

        .mobile-navbar-logo {
            display: flex !important;
            align-items: center !important;
            gap: 1rem !important;
        }

        .mobile-logo-image {
            width: 40px !important;
            height: 40px !important;
            border-radius: 10px !important;
            object-fit: cover !important;
            box-shadow: var(--glow-primary) !important;
        }

        .mobile-logo-text {
            font-family: 'Orbitron', monospace !important;
            font-size: 1.5rem !important;
            font-weight: 900 !important;
            background: var(--primary-gradient) !important;
            -webkit-background-clip: text !important;
            -webkit-text-fill-color: transparent !important;
            background-clip: text !important;
            letter-spacing: 1.5px !important;
        }

        .mobile-navbar-body {
            padding: 0 !important;
            overflow-y: auto !important;
            max-height: calc(100vh - 80px) !important;
        }

        /* Mobile User Profile */
        .mobile-user-profile {
            padding: 2rem !important;
            background: var(--bg-secondary) !important;
            border-bottom: 1px solid var(--border-color) !important;
            display: flex !important;
            align-items: center !important;
            gap: 1rem !important;
        }

        .mobile-user-avatar {
            width: 60px !important;
            height: 60px !important;
            border-radius: 50% !important;
            object-fit: cover !important;
            border: 2px solid transparent !important;
            background: var(--primary-gradient) !important;
            padding: 2px !important;
            box-shadow: var(--glow-primary) !important;
        }

        .mobile-user-info {
            flex: 1 !important;
        }

        .mobile-user-name {
            font-size: 1.2rem !important;
            font-weight: 600 !important;
            margin: 0 0 0.5rem 0 !important;
            display: flex !important;
            align-items: center !important;
            gap: 0.75rem !important;
            flex-wrap: wrap !important;
        }

        .mobile-credits-badge {
            background: var(--success-gradient) !important;
            color: var(--text-primary) !important;
            padding: 0.3rem 0.8rem !important;
            border-radius: 20px !important;
            font-size: 0.7rem !important;
            font-weight: 600 !important;
            display: inline-flex !important;
            align-items: center !important;
            gap: 0.3rem !important;
        }

        .mobile-user-role {
            font-size: 0.85rem !important;
            color: var(--text-secondary) !important;
            background: var(--accent-gradient) !important;
            -webkit-background-clip: text !important;
            -webkit-text-fill-color: transparent !important;
            background-clip: text !important;
            font-weight: 500 !important;
        }

        .mobile-logout-btn {
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            width: 44px !important;
            height: 44px !important;
            background: rgba(255, 107, 107, 0.1) !important;
            border: 1px solid rgba(255, 107, 107, 0.3) !important;
            border-radius: 12px !important;
            color: #ff6b6b !important;
            text-decoration: none !important;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
            position: relative !important;
            overflow: hidden !important;
            flex-shrink: 0 !important;
        }

        .mobile-logout-btn::before {
            content: '' !important;
            position: absolute !important;
            top: 0 !important;
            left: -100% !important;
            width: 100% !important;
            height: 100% !important;
            background: linear-gradient(90deg, transparent, rgba(255, 107, 107, 0.2), transparent) !important;
            transition: left 0.5s !important;
        }

        .mobile-logout-btn:hover::before {
            left: 100% !important;
        }

        .mobile-logout-btn:hover {
            background: rgba(255, 107, 107, 0.2) !important;
            border-color: #ff5252 !important;
            color: #ff5252 !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 12px rgba(255, 107, 107, 0.3) !important;
        }

        .mobile-logout-btn i {
            font-size: 1.1rem !important;
            z-index: 1 !important;
            position: relative !important;
        }

        /* Mobile Navigation Sections */
        .mobile-nav-section {
            padding: 1.75rem 2rem !important;
            border-bottom: 1px solid rgba(76, 126, 255, 0.15) !important;
            background: linear-gradient(180deg, transparent 0%, rgba(76, 126, 255, 0.02) 100%) !important;
        }

        .mobile-nav-section:last-child {
            border-bottom: none !important;
        }

        .mobile-nav-section-title {
            font-size: 1.1rem !important;
            font-weight: 700 !important;
            color: var(--text-primary) !important;
            margin-bottom: 1.25rem !important;
            display: flex !important;
            align-items: center !important;
            gap: 0.75rem !important;
            text-transform: uppercase !important;
            letter-spacing: 1px !important;
            padding: 0.75rem 1rem !important;
            background: rgba(76, 126, 255, 0.05) !important;
            border-radius: 12px !important;
            border: 1px solid rgba(76, 126, 255, 0.1) !important;
        }

        .mobile-nav-section-title i {
            font-size: 1.2rem !important;
            color: var(--accent-neon) !important;
            filter: drop-shadow(0 0 8px rgba(76, 126, 255, 0.5)) !important;
        }

        .mobile-nav-links {
            display: flex !important;
            flex-direction: column !important;
            gap: 0.5rem !important;
        }

        .mobile-nav-link {
            display: flex !important;
            align-items: center !important;
            gap: 1.125rem !important;
            padding: 1.125rem 1.5rem !important;
            color: var(--text-secondary) !important;
            text-decoration: none !important;
            border-radius: 14px !important;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1) !important;
            position: relative !important;
            overflow: hidden !important;
            background: rgba(255, 255, 255, 0.03) !important;
            border: 1px solid transparent !important;
            backdrop-filter: blur(10px) !important;
            margin-bottom: 0.5rem !important;
        }

        .mobile-nav-link::before {
            content: '' !important;
            position: absolute !important;
            top: 0 !important;
            left: -100% !important;
            width: 100% !important;
            height: 100% !important;
            background: linear-gradient(135deg, rgba(76, 126, 255, 0.15), rgba(93, 95, 239, 0.12)) !important;
            transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1) !important;
            z-index: -1 !important;
        }

        .mobile-nav-link::after {
            content: '' !important;
            position: absolute !important;
            left: 0 !important;
            top: 50% !important;
            transform: translateY(-50%) scaleY(0) !important;
            width: 4px !important;
            height: 0 !important;
            background: linear-gradient(180deg, var(--accent-neon), rgba(93, 95, 239, 0.8)) !important;
            border-radius: 0 4px 4px 0 !important;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1) !important;
        }

        .mobile-nav-link:hover::before,
        .mobile-nav-link.active::before {
            left: 0 !important;
        }

        .mobile-nav-link:hover::after,
        .mobile-nav-link.active::after {
            transform: translateY(-50%) scaleY(1) !important;
            height: 65% !important;
        }

        .mobile-nav-link:hover,
        .mobile-nav-link.active {
            color: var(--text-primary) !important;
            transform: translateX(6px) !important;
            box-shadow: 
                0 4px 16px rgba(76, 126, 255, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1) !important;
            border-color: rgba(76, 126, 255, 0.3) !important;
            background: rgba(76, 126, 255, 0.08) !important;
        }

        .mobile-nav-link.active {
            background: linear-gradient(135deg, rgba(76, 126, 255, 0.12), rgba(93, 95, 239, 0.08)) !important;
            border-color: rgba(76, 126, 255, 0.4) !important;
            box-shadow: 
                0 6px 20px rgba(76, 126, 255, 0.25),
                inset 0 1px 0 rgba(255, 255, 255, 0.15) !important;
        }

        .mobile-nav-link i {
            font-size: 1.3rem !important;
            width: 26px !important;
            text-align: center !important;
            flex-shrink: 0 !important;
            transition: transform 0.3s ease !important;
        }

        .mobile-nav-link:hover i,
        .mobile-nav-link.active i {
            transform: scale(1.1) !important;
        }

        .mobile-nav-link span {
            font-weight: 500 !important;
            font-size: 1.05rem !important;
            flex: 1 !important;
        }

        /* Mobile Badges */
        .mobile-badge {
            background: rgba(255, 255, 255, 0.2) !important;
            color: var(--text-primary) !important;
            padding: 0.25rem 0.75rem !important;
            border-radius: 20px !important;
            font-size: 0.7rem !important;
            font-weight: 600 !important;
            margin-left: auto !important;
        }

        .mobile-badge.new {
            background: var(--success-gradient) !important;
        }

        .mobile-badge.hot {
            background: linear-gradient(135deg, #ff4d4d, #ff0000) !important;
            box-shadow: 0 0 12px rgba(255, 77, 77, 0.4) !important;
        }

        .mobile-badge.admin-badge {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24) !important;
            color: white !important;
            font-size: 0.6rem !important;
            font-weight: 700 !important;
            text-transform: uppercase !important;
            letter-spacing: 0.5px !important;
        }

        /* Admin Link Styling */
        .mobile-nav-link.admin-link {
            position: relative !important;
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.08), rgba(238, 90, 36, 0.05)) !important;
            border: 1px solid rgba(255, 107, 107, 0.25) !important;
            box-shadow: 0 2px 8px rgba(255, 107, 107, 0.15) !important;
        }

        .mobile-nav-link.admin-link::after {
            background: linear-gradient(180deg, #ff6b6b, #ee5a24) !important;
            box-shadow: 0 0 12px rgba(255, 107, 107, 0.6) !important;
        }

        .mobile-nav-link.admin-link:hover {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.15), rgba(238, 90, 36, 0.1)) !important;
            border-color: rgba(255, 107, 107, 0.4) !important;
            box-shadow: 
                0 6px 20px rgba(255, 107, 107, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1) !important;
        }

        .mobile-nav-link.admin-link.active {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.2), rgba(238, 90, 36, 0.15)) !important;
            border-color: rgba(255, 107, 107, 0.5) !important;
            box-shadow: 
                0 8px 24px rgba(255, 107, 107, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.15) !important;
        }

        /* Modal Close Button - Styled like logout button */
        .mobile-navbar-modal .btn-close {
            filter: none !important;
            opacity: 1 !important;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1) !important;
            background: rgba(255, 107, 107, 0.12) !important;
            border: 2px solid rgba(255, 107, 107, 0.35) !important;
            border-radius: 10px !important;
            color: #ff6b6b !important;
            width: 38px !important;
            height: 38px !important;
            min-width: 38px !important;
            min-height: 38px !important;
            padding: 0 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            position: fixed !important;
            right: 32px !important;
            top: 18px !important;
            z-index: 99999 !important;
            box-shadow: none !important;
            backdrop-filter: none !important;
            animation: none !important;
            cursor: pointer !important;
            background-image: none !important;
        }
        
        .mobile-navbar-modal .btn-close::before {
            content: '√ó' !important;
            font-size: 1.3rem !important;
            font-weight: 700 !important;
            line-height: 1 !important;
            color: #ff6b6b !important;
            text-shadow: none !important;
            display: block !important;
        }
        
        /* Hide any default Bootstrap content */
        .mobile-navbar-modal .btn-close > * {
            display: none !important;
        }

        .mobile-navbar-modal .btn-close:hover {
            background: rgba(255, 107, 107, 0.25) !important;
            border-color: #ff5252 !important;
            color: #ff5252 !important;
            transform: translateY(-2px) scale(1.05) !important;
            box-shadow: 0 6px 16px rgba(255, 107, 107, 0.4) !important;
        }

        .mobile-navbar-modal .btn-close:active {
            transform: translateY(0) scale(1) !important;
        }

        /* Responsive adjustments for mobile navbar modal */
        @media (max-width: 480px) {
            .mobile-navbar-header {
                padding: 1rem 1.5rem !important;
            }

            .mobile-logo-text {
                font-size: 1.3rem !important;
            }

            .mobile-user-profile {
                padding: 1.5rem !important;
            }

            .mobile-user-avatar {
                width: 50px !important;
                height: 50px !important;
            }

            .mobile-user-name {
                font-size: 1.1rem !important;
            }

            .mobile-nav-section {
                padding: 1rem 1.5rem !important;
            }

            .mobile-nav-link {
                padding: 0.8rem 1rem !important;
            }

            .mobile-nav-link i {
                font-size: 1.1rem !important;
            }

            .mobile-nav-link span {
                font-size: 0.9rem !important;
            }
        }

        @media (max-width: 360px) {
            .mobile-navbar-header {
                padding: 0.8rem 1rem !important;
            }

            .mobile-user-profile {
                padding: 1rem !important;
            }

            .mobile-nav-section {
                padding: 0.8rem 1rem !important;
            }

            .mobile-nav-link {
                padding: 0.7rem 0.8rem !important;
            }
        }

        .mobile-nav-items {
                display: flex;
            justify-content: space-between;
                align-items: center;
            gap: 0.2rem;
            padding: 0 0.5rem;
                height: 100%;
            min-height: 50px;
                width: 100%;
            overflow: visible; /* Changed from hidden to visible to ensure notification badge is visible */
            }

        .mobile-nav-item {
            display: flex;
                flex-direction: column;
                align-items: center;
            justify-content: center;
            gap: 0.3rem;
            color: var(--text-secondary);
            text-decoration: none;
            padding: 0.5rem 0.4rem;
            border-radius: 14px;
            transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
            min-width: 44px;
            max-width: 60px;
            flex: 1;
            position: relative;
            overflow: hidden;
                height: 100%;
            min-height: 50px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid transparent;
            backdrop-filter: blur(8px);
        }

        .mobile-nav-item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(76, 126, 255, 0.2), rgba(93, 95, 239, 0.15));
            transition: left 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: -1;
            border-radius: 14px;
        }

        .mobile-nav-item:hover::before,
        .mobile-nav-item.active::before {
            left: 0;
        }

        .mobile-nav-item:hover,
        .mobile-nav-item.active {
            color: var(--text-primary);
            transform: translateY(-2px);
            box-shadow: 
                0 4px 12px rgba(76, 126, 255, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            border-color: rgba(76, 126, 255, 0.4);
            background: rgba(76, 126, 255, 0.1);
        }

        .mobile-nav-item.active {
            background: linear-gradient(135deg, rgba(76, 126, 255, 0.15), rgba(93, 95, 239, 0.1));
            box-shadow: 
                0 6px 16px rgba(76, 126, 255, 0.35),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        /* Hide specific mobile nav items on mobile */
        .mobile-nav-item-hidden {
            display: none !important;
        }

        /* Ensure notification bell is always visible (not hidden) */
        .mobile-nav-item.notification-bell-mobile.mobile-nav-item-hidden {
            display: flex !important;
        }

        /* Force notification bell to be visible on mobile */
        @media (max-width: 768px) {
            .mobile-nav-item.notification-bell-mobile {
                display: flex !important;
                visibility: visible !important;
                opacity: 1 !important;
            }
            
            .notification-icon-mobile {
                display: flex !important;
                visibility: visible !important;
            }
            
            .mobile-nav-item.notification-bell-mobile .mobile-nav-icon {
                display: inline-block !important;
                visibility: visible !important;
            }
        }

        /* Hide specific AI Tools items on mobile */
        @media (max-width: 768px) {
            .ai-tool-mobile-hidden {
                display: none !important;
            }
        }

        .mobile-nav-icon {
            font-size: 1.2rem;
            line-height: 1;
            transition: transform 0.3s ease;
        }

        .mobile-nav-item:hover .mobile-nav-icon,
        .mobile-nav-item.active .mobile-nav-icon {
            transform: scale(1.15);
        }

        /* Admin Mobile Button - Futuristic Design */
        .admin-mobile {
            position: relative;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24) !important;
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 
                0 0 20px rgba(255, 107, 107, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.2);
            animation: adminGlow 2s ease-in-out infinite alternate;
            flex-shrink: 0;
        }

        /* Admin Navigation Items Styling */
        .nav-item .nav-link[href*="/admin"] {
            position: relative;
            background: rgba(255, 107, 107, 0.1);
            border-left: 3px solid #ff6b6b;
        }

        .nav-item .nav-link[href*="/admin"]:hover {
            background: rgba(255, 107, 107, 0.2);
            border-left-color: #ff5252;
            transform: translateX(8px);
        }

        .nav-item .nav-link[href*="/admin"].active {
            background: rgba(255, 107, 107, 0.3);
            border-left-color: #ff5252;
            box-shadow: 0 0 15px rgba(255, 107, 107, 0.3);
        }

        /* Special styling for main Admin Panel link - Premium Design */
        .nav-item .nav-link[href="/admin"] {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.12), rgba(238, 90, 36, 0.08));
            border: 1px solid rgba(255, 107, 107, 0.3);
            position: relative;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(255, 107, 107, 0.15);
        }

        .nav-item .nav-link[href="/admin"]::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.12), transparent);
            transition: left 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-item .nav-link[href="/admin"]::after {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%) scaleY(0);
            width: 4px;
            height: 0;
            background: linear-gradient(180deg, #ff6b6b, #ee5a24);
            border-radius: 0 4px 4px 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 0 12px rgba(255, 107, 107, 0.6);
        }

        .nav-item .nav-link[href="/admin"]:hover::before {
            left: 100%;
        }

        .nav-item .nav-link[href="/admin"]:hover::after,
        .nav-item .nav-link[href="/admin"].active::after {
            transform: translateY(-50%) scaleY(1);
            height: 65%;
        }

        .nav-item .nav-link[href="/admin"]:hover {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.2), rgba(238, 90, 36, 0.15));
            border-color: rgba(255, 107, 107, 0.5);
            transform: translateX(6px);
            box-shadow: 
                0 6px 20px rgba(255, 107, 107, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .nav-item .nav-link[href="/admin"].active {
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.25), rgba(238, 90, 36, 0.18));
            border-color: rgba(255, 107, 107, 0.6);
            box-shadow: 
                0 8px 24px rgba(255, 107, 107, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        /* Quick Admin Access Styling */
        .quick-admin-access {
            padding: 1rem;
            border-bottom: 1px solid var(--border-color);
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.05), rgba(238, 90, 36, 0.05));
        }

        .quick-admin-btn {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            text-decoration: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(255, 107, 107, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .quick-admin-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .quick-admin-btn:hover::before {
            left: 100%;
        }

        .quick-admin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.5);
            background: linear-gradient(135deg, #ff5252, #d32f2f);
        }

        .quick-admin-btn i:first-child {
            font-size: 1.1rem;
        }

        .quick-admin-btn i:last-child {
            font-size: 0.8rem;
            margin-left: auto;
            transition: transform 0.3s ease;
        }

        .quick-admin-btn:hover i:last-child {
            transform: translateX(3px);
        }

        /* Admin Modal Styling */
        .modal.futuristic .modal-btn[href*="/admin"] {
            position: relative;
            overflow: hidden;
        }

        .modal.futuristic .modal-btn[href*="/admin"]::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }

        .modal.futuristic .modal-btn[href*="/admin"]:hover::after {
            left: 100%;
        }

        .admin-mobile::before {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24) !important;
        }

        .admin-mobile:hover,
        .admin-mobile.active {
            background: linear-gradient(135deg, #ff5252, #d32f2f) !important;
            transform: translateY(-3px) scale(1.05);
            box-shadow: 
                0 8px 25px rgba(255, 107, 107, 0.6),
                0 0 30px rgba(255, 107, 107, 0.8),
                inset 0 1px 0 rgba(255, 255, 255, 0.3);
        }

        .admin-icon-wrapper {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .admin-pulse {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255, 107, 107, 0.3) 0%, transparent 70%);
            animation: adminPulse 2s ease-in-out infinite;
            pointer-events: none;
        }

        .admin-mobile .mobile-nav-icon {
            color: #ffffff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.5);
            z-index: 2;
            position: relative;
        }

        /* Notification Bell Mobile Styling */
        .mobile-nav-item.notification-bell-mobile {
            position: relative;
            cursor: pointer;
            pointer-events: auto;
            z-index: 10;
            background: rgba(168, 85, 247, 0.05);
            border: 1px solid rgba(168, 85, 247, 0.2);
            touch-action: manipulation;
            min-height: 44px;
            min-width: 44px;
            display: flex !important; /* Ensure it's always visible */
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .mobile-nav-item.notification-bell-mobile::before {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.2), rgba(139, 92, 246, 0.15));
        }

        .mobile-nav-item.notification-bell-mobile:hover {
            background: rgba(168, 85, 247, 0.15);
            border-color: rgba(168, 85, 247, 0.4);
            box-shadow: 
                0 4px 12px rgba(168, 85, 247, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }

        .mobile-nav-item.notification-bell-mobile.active {
            background: linear-gradient(135deg, rgba(168, 85, 247, 0.2), rgba(139, 92, 246, 0.15));
            border-color: rgba(168, 85, 247, 0.5);
            box-shadow: 
                0 6px 16px rgba(168, 85, 247, 0.4),
                inset 0 1px 0 rgba(255, 255, 255, 0.15);
        }

        .notification-icon-mobile {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
            pointer-events: none;
            width: 100%;
            height: 100%;
        }

        .mobile-nav-item.notification-bell-mobile .mobile-nav-icon {
            color: #a855f7;
            transition: all 0.3s ease;
        }

        .mobile-nav-item.notification-bell-mobile:hover .mobile-nav-icon,
        .mobile-nav-item.notification-bell-mobile.active .mobile-nav-icon {
            color: #c084fc;
            transform: scale(1.15);
        }

        .notification-badge-mobile {
            position: absolute;
            top: -2px;
            right: -2px;
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            font-size: 0.6rem;
            font-weight: 700;
            padding: 2px 5px;
            border-radius: 10px;
            min-width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 6px rgba(255, 107, 107, 0.5);
            border: 1.5px solid rgba(255, 255, 255, 0.3);
            line-height: 1;
            z-index: 11;
            pointer-events: none;
            animation: pulse 2s infinite;
        }

        @keyframes adminGlow {
            0% {
                box-shadow: 
                    0 0 20px rgba(255, 107, 107, 0.4),
                    inset 0 1px 0 rgba(255, 255, 255, 0.2);
            }
            100% {
                box-shadow: 
                    0 0 30px rgba(255, 107, 107, 0.6),
                    inset 0 1px 0 rgba(255, 255, 255, 0.3);
            }
        }

        @keyframes adminPulse {
            0% {
                transform: translate(-50%, -50%) scale(0.8);
                opacity: 0.8;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.2);
                opacity: 0.4;
            }
            100% {
                transform: translate(-50%, -50%) scale(0.8);
                opacity: 0.8;
            }
        }



        @keyframes badgeGlow {
            0% {
                box-shadow: 0 2px 8px rgba(255, 107, 107, 0.4);
            }
            100% {
                box-shadow: 0 4px 15px rgba(255, 107, 107, 0.6);
            }
        }

        /* Responsive Admin Button */
        @media (max-width: 480px) {
            .admin-mobile {
                min-width: 55px;
                padding: 0.6rem;
            }
            
            .admin-mobile .mobile-nav-icon {
                font-size: 1.3rem;
            }
            
            .admin-pulse {
                width: 90%;
                height: 90%;
            }
        }

        @media (max-width: 360px) {
            .mobile-nav-items {
                gap: 0.3rem;
            }
            
            .admin-mobile {
                min-width: 50px;
                padding: 0.5rem;
            }
            
            .admin-mobile .mobile-nav-icon {
                font-size: 1.2rem;
            }
        }

        /* Modal Styles */
        .modal.futuristic .modal-dialog {
            max-width: 500px;
        }

        .modal.futuristic .modal-content {
            background: var(--bg-secondary);
            backdrop-filter: blur(20px);
            border: 1px solid var(--border-color);
            border-radius: 20px;
            color: var(--text-primary);
            box-shadow: var(--shadow-primary);
        }

        .modal.futuristic .modal-header {
            border-bottom: 1px solid var(--border-color);
            padding: 1.5rem 2rem;
        }

        .modal.futuristic .modal-title {
            font-family: 'Orbitron', monospace;
            font-weight: 700;
            background: var(--primary-gradient);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
        }

        .modal.futuristic .modal-body {
            padding: 2rem;
        }

        .modal.futuristic .btn-close {
            filter: invert(1);
            opacity: 0.7;
            transition: opacity 0.3s ease;
        }

        .modal.futuristic .btn-close:hover {
            opacity: 1;
        }

        .modal-btn {
          display: flex;
          align-items: center;
            gap: 1rem;
                width: 100%;
            padding: 1.25rem 1.5rem;
            margin-bottom: 1rem;
          border: none;
            border-radius: 16px;
            font-weight: 600;
            font-size: 1.1rem;
            text-decoration: none;
            transition: all 0.3s ease;
          position: relative;
            overflow: hidden;
        }

        .modal-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
                height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }

        .modal-btn:hover::before {
            left: 100%;
        }

        .modal-btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--glow-primary);
        }

        .modal-btn:last-child {
            margin-bottom: 0;
        }

        .btn-music {
            background: var(--success-gradient);
            color: var(--text-primary);
        }

        .btn-image {
            background: var(--warning-gradient);
            color: var(--text-primary);
        }

        .btn-video {
            background: var(--danger-gradient);
            color: var(--text-primary);
        }

        .btn-ai {
            background: var(--accent-gradient);
            color: var(--text-primary);
        }

        .btn-chat {
            background: var(--secondary-gradient);
            color: var(--text-primary);
        }

        .badge-modern {
            background: rgba(255, 255, 255, 0.2);
            color: var(--text-primary);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: auto;
        }

        .badge-modern.hot {
            background: linear-gradient(135deg, #ff4d4d, #ff0000);
            color: #fff;
            box-shadow: 0 0 12px rgba(255, 77, 77, 0.35);
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .sidebar {
                transform: translateX(-100%);
                width: 300px;
                box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
                backdrop-filter: blur(30px);
            }

            .sidebar.open {
                transform: translateX(0) !important;
                box-shadow: 4px 0 40px rgba(76, 126, 255, 0.2);
            }
            
            /* Ensure sidebar close button is always visible when sidebar is open */
            .sidebar.open .sidebar-close-btn,
            .sidebar.open #sidebarCloseBtn,
            body .sidebar.open .sidebar-close-btn,
            body .sidebar.open #sidebarCloseBtn {
                display: flex !important;
                opacity: 1 !important;
                visibility: visible !important;
                pointer-events: auto !important;
                position: fixed !important;
                right: 16px !important;
                top: 16px !important;
                z-index: 99999 !important;
                width: 56px !important;
                height: 56px !important;
            }

            /* Show close button on mobile */
            .sidebar-header { 
                position: relative !important;
                padding: 1.5rem 1.25rem 1.25rem !important;
                background: linear-gradient(180deg, rgba(76, 126, 255, 0.1) 0%, transparent 100%) !important;
                min-height: 80px !important;
                overflow: visible !important;
            }
            
            /* Close button - Base styles */
            .sidebar-close-btn {
                position: fixed !important;
                right: 16px !important;
                top: 16px !important;
                z-index: 99999 !important;
                width: 56px !important;
                height: 56px !important;
                min-width: 56px !important;
                min-height: 56px !important;
                background: linear-gradient(135deg, #ff3333, #cc0000) !important;
                border: 4px solid #ffffff !important;
                border-radius: 16px !important;
                transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1) !important;
                box-shadow: 
                    0 8px 32px rgba(255, 0, 0, 0.8),
                    0 0 0 4px rgba(255, 255, 255, 0.5),
                    0 0 24px rgba(255, 0, 0, 0.6),
                    inset 0 2px 0 rgba(255, 255, 255, 0.4),
                    inset 0 -2px 0 rgba(0, 0, 0, 0.3) !important;
                backdrop-filter: blur(20px) !important;
                animation: pulseGlow 1.5s ease-in-out infinite !important;
                cursor: pointer !important;
                transform: none !important;
                display: none !important;
                opacity: 0 !important;
                visibility: hidden !important;
                pointer-events: none !important;
            }
            
            /* Force show close button when sidebar is open on mobile */
            @media (max-width: 1024px) {
                /* Show when sidebar has open class - HIGHEST PRIORITY */
                .sidebar.open .sidebar-close-btn,
                .sidebar[class*="open"] .sidebar-close-btn,
                body .sidebar.open .sidebar-close-btn,
                html body .sidebar.open .sidebar-close-btn {
                    display: flex !important;
                    opacity: 1 !important;
                    visibility: visible !important;
                    pointer-events: auto !important;
                    position: fixed !important;
                    right: 16px !important;
                    top: 16px !important;
                    z-index: 99999 !important;
                }
                
                /* Show when sidebar is visible (not translated off-screen) */
                .sidebar:not([style*="translateX(-100%)"]) .sidebar-close-btn,
                .sidebar[style*="translateX(0)"] .sidebar-close-btn,
                .sidebar[style*="transform: translateX(0)"] .sidebar-close-btn {
                    display: flex !important;
                    opacity: 1 !important;
                    visibility: visible !important;
                    pointer-events: auto !important;
                    position: fixed !important;
                    right: 16px !important;
                    top: 16px !important;
                    z-index: 99999 !important;
                }
                
                /* Always ensure positioning */
                .sidebar .sidebar-close-btn {
                    position: fixed !important;
                    z-index: 99999 !important;
                    right: 16px !important;
                    top: 16px !important;
                }
            }
            
            /* Additional selector for Alpine.js reactive class */
            [x-data] .sidebar.open .sidebar-close-btn,
            html [x-data] .sidebar.open .sidebar-close-btn {
                display: flex !important;
                opacity: 1 !important;
                visibility: visible !important;
                pointer-events: auto !important;
                position: fixed !important;
                right: 16px !important;
                top: 16px !important;
                z-index: 99999 !important;
            }

            @keyframes pulseGlow {
                0%, 100% {
                    box-shadow: 
                        0 8px 32px rgba(255, 0, 0, 0.8),
                        0 0 0 4px rgba(255, 255, 255, 0.5),
                        0 0 24px rgba(255, 0, 0, 0.6),
                        inset 0 2px 0 rgba(255, 255, 255, 0.4),
                        inset 0 -2px 0 rgba(0, 0, 0, 0.3);
                    transform: scale(1);
                    border-color: #ffffff;
                }
                50% {
                    box-shadow: 
                        0 12px 40px rgba(255, 0, 0, 0.95),
                        0 0 0 6px rgba(255, 255, 255, 0.7),
                        0 0 32px rgba(255, 0, 0, 0.8),
                        inset 0 2px 0 rgba(255, 255, 255, 0.5),
                        inset 0 -2px 0 rgba(0, 0, 0, 0.3);
                    transform: scale(1.06);
                    border-color: rgba(255, 255, 255, 0.9);
                }
            }

            .sidebar-close-btn i {
                font-size: 1.75rem !important;
                color: #ffffff !important;
                font-weight: 900 !important;
                text-shadow: 
                    0 3px 10px rgba(0, 0, 0, 0.7),
                    0 0 16px rgba(255, 255, 255, 0.5),
                    0 0 24px rgba(255, 255, 255, 0.3) !important;
                filter: drop-shadow(0 0 6px rgba(255, 255, 255, 0.8)) !important;
                line-height: 1 !important;
                display: flex !important;
                align-items: center !important;
                justify-content: center !important;
                width: 100% !important;
                height: 100% !important;
            }

            .sidebar-close-btn:hover,
            .sidebar-close-btn:active {
                background: linear-gradient(135deg, #ff0000, #cc0000) !important;
                border-color: #ffffff !important;
                transform: scale(1.12) rotate(90deg) !important;
                box-shadow: 
                    0 10px 36px rgba(255, 0, 0, 0.95),
                    0 0 0 5px rgba(255, 255, 255, 0.7),
                    0 0 28px rgba(255, 0, 0, 0.8),
                    inset 0 2px 0 rgba(255, 255, 255, 0.4),
                    inset 0 -2px 0 rgba(0, 0, 0, 0.3) !important;
                animation: none !important;
            }

            .sidebar-close-btn:active {
                transform: scale(1.05) rotate(90deg) !important;
            }

            .nav-menu {
                padding: 1.25rem 1rem;
            }

            .nav-link {
                padding: 1rem 1.25rem;
                margin-bottom: 0.5rem;
                border-radius: 14px;
                font-size: 0.95rem;
            }

            .nav-icon {
                font-size: 1.2rem;
                width: 24px;
            }

            .nav-text {
                font-size: 0.95rem;
                font-weight: 500;
            }

            .ai-tools-section,
            .chat-section {
                padding: 1.25rem 1rem;
                margin-top: 1rem;
            }

            .ai-tools-header {
                padding: 0.75rem 1rem;
                margin-bottom: 1.25rem;
            }

            .ai-tools-title {
                font-size: 0.9rem;
            }

            .ai-tool-item,
            .chat-item {
                padding: 0.875rem 1.125rem;
                font-size: 0.9rem;
                border-radius: 12px;
                margin-bottom: 0.5rem;
            }

            .ai-tool-item i,
            .chat-item i {
                font-size: 1.1rem;
                width: 22px;
            }

            .ai-tools-title,
            .chat-title {
                font-size: 0.85rem;
            }

            .main-content {
                margin-left: 0;
            }

            .content-wrapper {
                padding: 1rem;
            }

            /* Admin elements responsive */
            .nav-item .nav-link[href*="/admin"] {
                border-left-width: 3px;
                padding-left: 1.125rem;
            }

            .nav-item .nav-link[href*="/admin"]:hover {
                transform: translateX(6px);
            }

            /* Quick admin access responsive */
            .quick-admin-access {
                padding: 1rem;
                margin: 1rem;
                border-radius: 14px;
                background: linear-gradient(135deg, rgba(255, 107, 107, 0.08), rgba(238, 90, 36, 0.05));
                border: 1px solid rgba(255, 107, 107, 0.2);
            }

            .quick-admin-btn {
                padding: 0.875rem 1.25rem;
                font-size: 0.95rem;
                border-radius: 14px;
            }

            .quick-admin-btn i:first-child {
                font-size: 1.2rem;
            }
        }

        @media (max-width: 768px) {
            .mobile-nav {
                display: block !important;
                /* Ensure fixed position on iOS */
                position: fixed !important;
                bottom: 0 !important;
                left: 0 !important;
                right: 0 !important;
                width: 100% !important;
                z-index: 9999 !important;
            }

            .content-wrapper {
                margin-bottom: 80px;
                /* Prevent iOS scroll issues */
                -webkit-overflow-scrolling: touch;
            }
            
            /* iOS Safari specific fixes */
            @supports (-webkit-touch-callout: none) {
                html, body {
                    -webkit-overflow-scrolling: touch;
                    overflow-x: hidden;
                    height: 100%;
                    position: relative;
                }
                
                .mobile-nav {
                    position: fixed !important;
                    bottom: 0 !important;
                    left: 0 !important;
                    right: 0 !important;
                    width: 100% !important;
                    max-width: 100vw !important;
                    margin: 0 !important;
                    padding-left: 0 !important;
                    padding-right: 0 !important;
                    -webkit-transform: translate3d(0, 0, 0) !important;
                    transform: translate3d(0, 0, 0) !important;
                    -webkit-backface-visibility: hidden !important;
                    backface-visibility: hidden !important;
                    top: auto !important;
                    z-index: 99999 !important;
                }
                
                /* Prevent parent transforms from affecting fixed nav */
                main.main-content,
                .content-wrapper {
                    -webkit-transform: none !important;
                    transform: none !important;
                }
            }
            
            /* Hide admin panel in sidebar on mobile (already in mobile nav) */
            .nav-item .nav-link[href="/admin"] {
                display: none !important;
            }
            
            /* Ensure admin panel is visible in mobile nav */
            .admin-mobile {
                display: flex !important;
            }
            
            /* Ensure notification bell is visible in mobile nav */
            .mobile-nav-item.notification-bell-mobile {
                display: flex !important;
            }
            
            .notification-bell-mobile {
                display: flex !important;
            }
        }

        /* Ensure mobile nav is hidden on desktop */
        @media (min-width: 769px) {
            .mobile-nav {
                display: none !important;
            }
            
            /* Ensure admin panel is visible in sidebar on desktop */
            .admin-mobile {
                display: none !important;
            }
            
            /* Ensure notification bell is hidden in mobile nav on desktop */
            .mobile-nav-item.notification-bell-mobile {
                display: none !important;
            }
            
            .notification-bell-mobile {
                display: none !important;
            }

            /* Hide close button on desktop */
            .sidebar-close-btn { display: none !important; }
        }

        @media (max-width: 768px) {
            .content-wrapper {
                padding: 1rem 0.5rem;
            }

            .modal.futuristic .modal-dialog {
                margin: 1rem;
            }

            .modal.futuristic .modal-body {
                padding: 1.5rem;
            }

            /* Admin modal mobile styling */
            .modal.futuristic .modal-btn {
                padding: 1rem 1.25rem;
                font-size: 1rem;
            }

            .modal.futuristic .modal-btn i {
                font-size: 1.2rem;
            }

            .badge-modern {
                font-size: 0.7rem;
                padding: 0.2rem 0.6rem;
            }
        }

        @media (max-width: 480px) {
            .user-profile {
                padding: 1rem 0.75rem;
                overflow: hidden;
                max-width: 100%;
            }
            
            .user-info {
                overflow: hidden;
                max-width: 100%;
            }
            
            .user-name-row {
                overflow: hidden;
                max-width: 100%;
            }
            
            .user-name-wrapper {
                overflow: hidden;
                max-width: 100%;
            }
            
            .user-name-text {
                font-size: 0.9rem;
                max-width: 100%;
            }
            
            .credits-badge {
                font-size: 0.6rem;
                padding: 0.2rem 0.5rem;
                max-width: fit-content;
            }
            
            .logout-btn {
                width: 36px !important;
                height: 36px !important;
                min-width: 36px !important;
                min-height: 36px !important;
                flex-shrink: 0;
            }
            
            .notification-bell-sidebar {
                flex-shrink: 0;
            }

            .nav-menu {
                padding: 0.75rem 0.5rem;
            }

            .nav-link {
                padding: 0.6rem 0.8rem;
            }

            .nav-text {
                font-size: 0.8rem;
            }

            .nav-icon {
                font-size: 0.9rem;
            }

            .mobile-nav {
                padding: 0.3rem;
            }

            .mobile-nav-items {
                gap: 0.15rem;
                padding: 0 0.3rem;
            }

            .mobile-nav-item {
                padding: 0.3rem;
                min-width: 35px;
                max-width: 45px;
            }

            .mobile-nav-icon {
                font-size: 0.9rem;
            }

            .notification-badge-mobile {
                font-size: 0.45rem;
                padding: 1px 3px;
                min-width: 12px;
            }
        }

        @media (max-width: 360px) {
            .mobile-nav {
                padding: 0.25rem;
            }

            .mobile-nav-items {
                gap: 0.1rem;
                padding: 0 0.2rem;
            }

            .mobile-nav-item {
                padding: 0.2rem;
                min-width: 30px;
                max-width: 40px;
            }

            .mobile-nav-icon {
                font-size: 0.8rem;
            }

            .notification-badge-mobile {
                font-size: 0.4rem;
                padding: 1px 2px;
                min-width: 10px;
            }
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
          opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes slideInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
            }
            50% {
                transform: scale(1.05);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.6s ease-out;
        }

        .slide-in-left {
            animation: slideInLeft 0.6s ease-out;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        /* Loading States */
        .loading {
            position: relative;
            overflow: hidden;
        }

        .loading::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% {
                left: -100%;
            }
            100% {
                left: 100%;
            }
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <nav class="sidebar" :class="{ 'open': sidebarOpen }">
        <div class="sidebar-header">
            <div class="logo-container">
                <img src="/static/assets/image/logo.png" alt="INEMI Logo" class="logo-image">
                <span class="logo-text">INEMI</span>
            </div>
        </div>
        
        <!-- Close Menu Button for Mobile - Outside sidebar header -->
        <button class="sidebar-close-btn" 
                @click="sidebarOpen = false" 
                onclick="const sidebar = this.closest('.sidebar'); if(sidebar) { sidebar.classList.remove('open'); } if(window.Alpine) { try { const root = document.querySelector('[x-data]'); if(root && root._x_dataStack) { root._x_dataStack[0].sidebarOpen = false; } } catch(e) {} }" 
                title="Close Menu"
                id="sidebarCloseBtn">
            <i class="bi bi-x-lg"></i>
        </button>
        
        <div class="user-profile">
            <img src="{{ session['avatar_url'] if session.get('avatar_url') else '/static/assets/image/default.jpg' }}" alt="User Avatar" class="user-avatar">
            <div class="user-info">
                <div class="user-name-row">
                    <div class="user-name-wrapper">
                        <span class="user-name-text">{{ session['username'] if session.get('username') else 'User' }}</span>
                        <span class="credits-badge">
                            <i class="bi bi-currency-dollar" style="font-size:1.1em;margin-right:6px;color:#fff;font-weight:bold;"></i>
                            <span style="font-weight:700;">{{ current_user.kredit if current_user and current_user.kredit is not none else (session.get('kredit', 0) if session.get('kredit') is not none else 0) }}</span>
                        </span>
                    </div>
                    <div class="user-actions">
                        <!-- Notification Bell next to user name -->
                        <div class="notification-bell-sidebar" id="notification-bell-sidebar">
                            <div class="notification-icon-sidebar" id="notification-icon-sidebar">
                                <i class="bi bi-bell"></i>
                                <span class="notification-badge-sidebar" id="notification-badge-sidebar">0</span>
                            </div>
                        </div>
                        <!-- Logout Button -->
                        <a href="/logout" class="logout-btn" title="Logout">
                            <i class="bi bi-box-arrow-right"></i>
                        </a>
                    </div>
                </div>
                <div class="user-role">{{ session.get('role', 'free').title() }} User</div>
            </div>
        </div>


        <div class="nav-menu">
            <div class="nav-item">
                <a href="/home" class="nav-link{% if request.path.startswith('/home') %} active{% endif %}">
                    <i class="bi bi-house nav-icon"></i>
                    <span class="nav-text">Home</span>
                </a>
                </div>

            <div class="nav-item">
                <a href="/search" class="nav-link{% if request.path == '/search' %} active{% endif %}">
                    <i class="bi bi-search nav-icon"></i>
                    <span class="nav-text">Search</span>
                </a>
                </div>
                
                <div class="nav-item">
                  <a href="/explore" class="nav-link{% if request.path == '/explore' %} active{% endif %}">
                      <i class="bi bi-compass nav-icon"></i>
                      <span class="nav-text">Explore</span>
                  </a>
                </div>

            <div class="nav-item">
                <a href="/profil" class="nav-link{% if request.path.startswith('/profil') %} active{% endif %}">
                    <i class="bi bi-person-circle nav-icon"></i>
                    <span class="nav-text">Profile</span>
                </a>
            </div>

            {% if session.get('role') == 'admin' or (current_user and current_user.role == 'admin') %}
            <div class="nav-item">
                <a href="/admin" class="nav-link{% if request.path.startswith('/admin') %} active{% endif %}">
                    <i class="bi bi-shield-lock nav-icon"></i>
                    <span class="nav-text">Admin Panel</span>
                    <span class="admin-badge">ADMIN</span>
                </a>
            </div>
        
            {% endif %}
                </div>

        <!-- AI Tools Section -->
        <div class="ai-tools-section">
            <div class="ai-tools-header">
                <i class="bi bi-magic"></i>
                <span class="ai-tools-title">AI Tools</span>
            </div>
            <div class="ai-tools-menu">
                <a href="/ai_generate" class="ai-tool-item" {% if request.path == '/ai_generate' %}style="background: rgba(76, 126, 255, 0.15); border-color: var(--accent-neon);"{% endif %}>
                    <i class="bi bi-cpu-fill"></i>
                            <span class="ai-tool-text">Smart AI Generate</span>
                    <span class="ai-tool-badge hot">HOT</span>
                </a>

                <a href="/generate_music" class="ai-tool-item" {% if session.get('role') == 'notfree' and session.get('music_trial', 0) >= 2 %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                    <i class="bi bi-music-note-beamed"></i>
                    <span class="ai-tool-text">Music</span>
                    {% if session.get('role') == 'notfree' %}
                    <span class="ai-tool-badge">2x/day</span>
                    {% endif %}
                </a>

                <a href="{% if session.get('role') == 'notfree' %}#{% else %}/generate_image{% endif %}" class="ai-tool-item" {% if session.get('role') == 'notfree' %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                    <i class="bi bi-image"></i>
                    <span class="ai-tool-text">Image</span>
                    {% if session.get('role') == 'notfree' %}
                    <span class="ai-tool-badge">Pro</span>
                    {% endif %}
                </a>

                <a href="/generate_miniatur" class="ai-tool-item">
                    <i class="bi bi-magic"></i>
                    <span class="ai-tool-text">Miniatur</span>
                </a>

                <a href="{% if session.get('role') == 'free' %}#{% else %}/generate_video{% endif %}" class="ai-tool-item" {% if session.get('role') == 'free' %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                    <i class="bi bi-film"></i>
                    <span class="ai-tool-text">Video</span>
                    {% if session.get('role') == 'free' %}
                    <span class="ai-tool-badge">Pro</span>
                    {% endif %}
                </a>

                <a href="{% if session.get('role') == 'free' %}#{% else %}/generate_video_avatar{% endif %}" class="ai-tool-item" {% if session.get('role') == 'free' %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                    <i class="bi bi-person-video3"></i>
                    <span class="ai-tool-text">Avatar</span>
                    {% if session.get('role') == 'free' %}
                    <span class="ai-tool-badge">Pro</span>
                    {% endif %}
                </a>

                <a href="/generate_banner" class="ai-tool-item">
                    <i class="bi bi-image"></i>
                    <span class="ai-tool-text">Banner</span>
                    <span class="ai-tool-badge new">New</span>
                </a>
            </div>
        </div>

        <!-- Chat Section -->
        {% if request.path != '/ai_generate' and request.path != '/explore' %}
        <div class="chat-section">
            <div class="chat-header">
                <i class="bi bi-chat-dots"></i>
                <span class="chat-title">Chat</span>
            </div>
            <div class="chat-menu">
                <a href="/ai_chat" class="chat-item">
                    <i class="bi bi-robot"></i>
                    <span class="chat-text">AI Prompt</span>
                </a>
                <a href="/chat" class="chat-item">
                    <i class="bi bi-chat-dots"></i>
                    <span class="chat-text">Chat</span>
                </a>
            </div>
        </div>
        {% endif %}
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <div class="content-wrapper">
        {% block content %}
        {% endblock %}
    </div>
    </main>

    <!-- Mobile Navigation -->
    <nav class="mobile-nav">
        <div class="mobile-nav-items">
            <!-- Mobile Menu Button -->
            <button class="mobile-nav-item mobile-menu-btn" data-bs-toggle="modal" data-bs-target="#mobileNavbarModal">
                <i class="bi bi-list mobile-nav-icon"></i>
            </button>
            
            <a href="/home" class="mobile-nav-item{% if request.path.startswith('/home') %} active{% endif %}">
                <i class="bi bi-house mobile-nav-icon"></i>
            </a>
            <a href="/search" class="mobile-nav-item mobile-nav-item-hidden{% if request.path == '/search' %} active{% endif %}">
                <i class="bi bi-search mobile-nav-icon"></i>
            </a>
            <button class="mobile-nav-item" data-bs-toggle="modal" data-bs-target="#aiToolsModal">
                <i class="bi bi-magic mobile-nav-icon"></i>
            </button>
            <a href="/explore" class="mobile-nav-item{% if request.path == '/explore' %} active{% endif %}">
                <i class="bi bi-compass mobile-nav-icon"></i>
            </a>
            <a href="/ai_chat" class="mobile-nav-item mobile-nav-item-hidden">
                <i class="bi bi-robot mobile-nav-icon"></i>
            </a>
            <a href="/profil" class="mobile-nav-item{% if request.path.startswith('/profil') %} active{% endif %}">
                <i class="bi bi-person-circle mobile-nav-icon"></i>
            </a>
            {% if session.get('role') == 'admin' or (current_user and current_user.role == 'admin') %}
            <a href="#" class="mobile-nav-item admin-mobile" data-bs-toggle="modal" data-bs-target="#adminModal">
                <div class="admin-icon-wrapper">
                    <i class="bi bi-shield-lock mobile-nav-icon"></i>
                    <div class="admin-pulse"></div>
                </div>
            </a>
            {% endif %}
    </div>
    </nav>

    <!-- Admin Modal for Mobile -->
    {% if session.get('role') == 'admin' or (current_user and current_user.role == 'admin') %}
    <div class="modal fade futuristic" id="adminModal" tabindex="-1" aria-labelledby="adminModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="adminModalLabel">
                        <i class="bi bi-shield-lock me-2"></i>Admin Panel
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <a href="/admin" class="modal-btn btn-music">
                        <i class="bi bi-shield-lock"></i>
                        <span>Dashboard</span>
                        <span class="badge-modern">Main</span>
                    </a>
                    <a href="/admin/users" class="modal-btn btn-image">
                        <i class="bi bi-people"></i>
                        <span>User Management</span>
                        <span class="badge-modern">Users</span>
                    </a>
                    <a href="/admin/analytics" class="modal-btn btn-video">
                        <i class="bi bi-graph-up"></i>
                        <span>Analytics</span>
                        <span class="badge-modern">Stats</span>
                    </a>
                    <a href="/admin/settings" class="modal-btn btn-ai">
                        <i class="bi bi-gear"></i>
                        <span>System Settings</span>
                        <span class="badge-modern">Config</span>
                    </a>
                    <a href="/admin/logs" class="modal-btn btn-chat">
                        <i class="bi bi-file-text"></i>
                        <span>System Logs</span>
                        <span class="badge-modern">Logs</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- AI Tools Modal for Mobile -->
    <div class="modal fade futuristic" id="aiToolsModal" tabindex="-1" aria-labelledby="aiToolsModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="aiToolsModalLabel">
                        <i class="bi bi-magic me-2"></i>AI Tools
                    </h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <a href="/ai_generate" class="modal-btn btn-ai">
                        <i class="bi bi-cpu-fill"></i>
                        <span>Smart AI Generate</span>
                        <span class="badge-modern hot">HOT</span>
                    </a>
                    <a href="/generate_music" class="modal-btn btn-music ai-tool-mobile-hidden" {% if session.get('role') == 'notfree' and session.get('music_trial', 0) >= 2 %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                        <i class="bi bi-music-note-beamed"></i>
                        <span>Generate Music</span>
                        {% if session.get('role') == 'notfree' %}
                        <span class="badge-modern">2x/day</span>
                        {% endif %}
                    </a>
                    <a href="{% if session.get('role') == 'notfree' %}#{% else %}/generate_image{% endif %}" class="modal-btn btn-image ai-tool-mobile-hidden" {% if session.get('role') == 'notfree' %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                        <i class="bi bi-image"></i>
                        <span>Generate Image</span>
                        {% if session.get('role') == 'notfree' %}
                        <span class="badge-modern">Pro</span>
                        {% endif %}
                    </a>
                    <a href="/generate_miniatur" class="modal-btn btn-ai ai-tool-mobile-hidden">
                        <i class="bi bi-magic"></i>
                        <span>Generate Miniatur</span>
                    </a>
                    <a href="{% if session.get('role') == 'free' %}#{% else %}/generate_video{% endif %}" class="modal-btn btn-video ai-tool-mobile-hidden" {% if session.get('role') == 'free' %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                        <i class="bi bi-film"></i>
                        <span>Generate Video</span>
                        {% if session.get('role') == 'free' %}
                        <span class="badge-modern">Pro</span>
                        {% endif %}
                    </a>
                    <a href="{% if session.get('role') == 'free' %}#{% else %}/generate_video_avatar{% endif %}" class="modal-btn btn-chat" {% if session.get('role') == 'free' %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                        <i class="bi bi-person-video3"></i>
                        <span>Generate Avatar</span>
                        {% if session.get('role') == 'free' %}
                        <span class="badge-modern">Pro</span>
                        {% endif %}
                    </a>
                    <a href="/generate_banner" class="modal-btn btn-music">
                        <i class="bi bi-image"></i>
                        <span>Generate Banner</span>
                        <span class="badge-modern">New</span>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Mobile Navbar Modal -->
    <div class="modal fade futuristic" id="mobileNavbarModal" tabindex="-1" aria-labelledby="mobileNavbarModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered modal-fullscreen">
            <div class="modal-content mobile-navbar-modal">
                <div class="modal-header mobile-navbar-header">
                    <div class="mobile-navbar-logo">
                        <img src="/static/assets/image/logo.png" alt="INEMI Logo" class="mobile-logo-image">
                        <span class="mobile-logo-text">INEMI</span>
                    </div>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                
                <div class="modal-body mobile-navbar-body">
                    <!-- User Profile Section -->
                    <div class="mobile-user-profile">
                        <img src="{{ session['avatar_url'] if session.get('avatar_url') else '/static/assets/image/default.jpg' }}" alt="User Avatar" class="mobile-user-avatar">
                        <div class="mobile-user-info">
                            <h4 class="mobile-user-name">
                                {{ session['username'] if session.get('username') else 'User' }}
                                <span class="mobile-credits-badge">
                                    <i class="bi bi-currency-dollar"></i>
                                    <span>{{ current_user.kredit if current_user and current_user.kredit is not none else (session.get('kredit', 0) if session.get('kredit') is not none else 0) }}</span>
                                </span>
                            </h4>
                            <div class="mobile-user-role">{{ session.get('role', 'free').title() }} User</div>
                        </div>
                        <!-- Mobile Logout Button -->
                        <a href="/logout" class="mobile-logout-btn" title="Logout">
                            <i class="bi bi-box-arrow-right"></i>
                        </a>
                    </div>

                    <!-- Main Navigation -->
                    <div class="mobile-nav-section">
                        <h5 class="mobile-nav-section-title">Navigation</h5>
                        <div class="mobile-nav-links">
                            <a href="/home" class="mobile-nav-link{% if request.path.startswith('/home') %} active{% endif %}">
                                <i class="bi bi-house"></i>
                                <span>Home</span>
                            </a>
                            <a href="/search" class="mobile-nav-link{% if request.path == '/search' %} active{% endif %}">
                                <i class="bi bi-search"></i>
                                <span>Search</span>
                            </a>
                            <a href="/explore" class="mobile-nav-link{% if request.path == '/explore' %} active{% endif %}">
                                <i class="bi bi-compass"></i>
                                <span>Explore</span>
                            </a>
                            <a href="/profil" class="mobile-nav-link{% if request.path.startswith('/profil') %} active{% endif %}">
                                <i class="bi bi-person-circle"></i>
                                <span>Profile</span>
                            </a>
                        </div>
                    </div>

                    <!-- AI Tools Section -->
                    <div class="mobile-nav-section">
                        <h5 class="mobile-nav-section-title">
                            <i class="bi bi-magic"></i>
                            AI Tools
                        </h5>
                        <div class="mobile-nav-links">
                            <a href="/ai_generate" class="mobile-nav-link{% if request.path == '/ai_generate' %} active{% endif %}">
                                <i class="bi bi-cpu-fill"></i>
                                <span>Smart AI Generate</span>
                                <span class="mobile-badge hot">HOT</span>
                            </a>
                            <a href="/generate_music" class="mobile-nav-link" {% if session.get('role') == 'notfree' and session.get('music_trial', 0) >= 2 %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                                <i class="bi bi-music-note-beamed"></i>
                                <span>Music</span>
                                {% if session.get('role') == 'notfree' %}
                                <span class="mobile-badge">2x/day</span>
                                {% endif %}
                            </a>
                            <a href="{% if session.get('role') == 'notfree' %}#{% else %}/generate_image{% endif %}" class="mobile-nav-link" {% if session.get('role') == 'notfree' %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                                <i class="bi bi-image"></i>
                                <span>Image</span>
                                {% if session.get('role') == 'notfree' %}
                                <span class="mobile-badge">Pro</span>
                                {% endif %}
                            </a>
                            <a href="/generate_miniatur" class="mobile-nav-link">
                                <i class="bi bi-magic"></i>
                                <span>Miniatur</span>
                            </a>
                            <a href="{% if session.get('role') == 'free' %}#{% else %}/generate_video{% endif %}" class="mobile-nav-link" {% if session.get('role') == 'free' %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                                <i class="bi bi-film"></i>
                                <span>Video</span>
                                {% if session.get('role') == 'free' %}
                                <span class="mobile-badge">Pro</span>
                                {% endif %}
                            </a>
                            <a href="{% if session.get('role') == 'free' %}#{% else %}/generate_video_avatar{% endif %}" class="mobile-nav-link" {% if session.get('role') == 'free' %}style="opacity: 0.5; pointer-events: none;"{% endif %}>
                                <i class="bi bi-person-video3"></i>
                                <span>Avatar</span>
                                {% if session.get('role') == 'free' %}
                                <span class="mobile-badge">Pro</span>
                                {% endif %}
                            </a>
                            <a href="/generate_banner" class="mobile-nav-link">
                                <i class="bi bi-image"></i>
                                <span>Banner</span>
                                <span class="mobile-badge new">New</span>
                            </a>
                        </div>
                    </div>

                    <!-- Chat Section -->
                    {% if request.path != '/ai_generate' and request.path != '/explore' %}
                    <div class="mobile-nav-section">
                        <h5 class="mobile-nav-section-title">
                            <i class="bi bi-chat-dots"></i>
                            Chat
                        </h5>
                        <div class="mobile-nav-links">
                            <a href="/ai_chat" class="mobile-nav-link">
                                <i class="bi bi-robot"></i>
                                <span>AI Prompt</span>
                            </a>
                            <a href="/chat" class="mobile-nav-link">
                                <i class="bi bi-chat-dots"></i>
                                <span>Chat</span>
                            </a>
                        </div>
                    </div>
                    {% endif %}

                    <!-- Admin Section -->
                    {% if session.get('role') == 'admin' or (current_user and current_user.role == 'admin') %}
                    <div class="mobile-nav-section">
                        <h5 class="mobile-nav-section-title">
                            <i class="bi bi-shield-lock"></i>
                            Admin Panel
                        </h5>
                        <div class="mobile-nav-links">
                            <a href="/admin" class="mobile-nav-link admin-link">
                                <i class="bi bi-shield-lock"></i>
                                <span>Dashboard</span>
                                <span class="mobile-badge admin-badge">ADMIN</span>
                            </a>
                            <a href="/admin/users" class="mobile-nav-link admin-link">
                                <i class="bi bi-people"></i>
                                <span>User Management</span>
                            </a>
                            <a href="/admin/analytics" class="mobile-nav-link admin-link">
                                <i class="bi bi-graph-up"></i>
                                <span>Analytics</span>
                            </a>
                            <a href="/admin/settings" class="mobile-nav-link admin-link">
                                <i class="bi bi-gear"></i>
                                <span>System Settings</span>
                            </a>
                            <a href="/admin/logs" class="mobile-nav-link admin-link">
                                <i class="bi bi-file-text"></i>
                                <span>System Logs</span>
                            </a>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

    <!-- View Tracking Script -->
    <script src="{{ url_for('static', filename='js/view-tracking.js') }}"></script>
    
    <!-- Notification System Script -->
    <script src="{{ url_for('static', filename='js/notifications.js') }}"></script>
    <script>
    // Initialize notification system in base.html
    document.addEventListener('DOMContentLoaded', function() {
        if (typeof NotificationSystem !== 'undefined' && !window.notificationSystem) {
            window.notificationSystem = new NotificationSystem();
            console.log('Notification system initialized in base.html');
        }
    });
    </script>

    <!-- AI Assistant Widget -->
{% if session.get('username') and request.path != '/ai_generate' and request.path != '/explore' %}
  <div id="ai-assistant-widget"></div>
  <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/ai-assistant.css') }}">
  <script src="{{ url_for('static', filename='assets/js/ai-assistant.js') }}"></script>
{% endif %}

<script>
// Global session handler
document.addEventListener('DOMContentLoaded', function() {
    // Intercept all fetch requests to handle session expired
    const originalFetch = window.fetch;
    window.fetch = function(...args) {
        return originalFetch.apply(this, args).then(response => {
            if (response.status === 401) {
                console.log('Session expired, redirecting to login');
                window.location.href = '/login';
                return Promise.reject(new Error('Session expired'));
            }
            return response;
        });
    };
    
    // Add credentials to all fetch requests
    const originalFetchWithCredentials = window.fetch;
    window.fetch = function(url, options = {}) {
        if (options.credentials === undefined) {
            options.credentials = 'same-origin';
        }
        return originalFetchWithCredentials(url, options);
    };

            // Add smooth scrolling
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        target.scrollIntoView({
                            behavior: 'smooth',
                            block: 'start'
                        });
                    }
                });
            });

            // Add loading states
            document.querySelectorAll('.modal-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    if (!this.hasAttribute('disabled')) {
                        this.classList.add('loading');
                        setTimeout(() => {
                            this.classList.remove('loading');
                        }, 2000);
                    }
                });
            });

            // Sidebar toggle functionality for mobile
            function initSidebarToggle() {
                const sidebar = document.querySelector('.sidebar');
                const closeBtn = document.querySelector('.sidebar-close-btn') || document.getElementById('sidebarCloseBtn');
                const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
                
                if (!sidebar) {
                    console.error('Sidebar not found!');
                    return;
                }
                
                if (!closeBtn) {
                    console.error('Close button not found!');
                    return;
                }
                
                console.log('Initializing sidebar toggle:', { sidebar, closeBtn, mobileMenuBtn });
                
                // Function to show/hide close button based on sidebar state
                function updateCloseButton() {
                    if (window.innerWidth > 1024) {
                        closeBtn.style.display = 'none';
                        return;
                    }
                    
                    const computedStyle = getComputedStyle(sidebar);
                    const transform = computedStyle.transform;
                    const hasOpenClass = sidebar.classList.contains('open');
                    const isVisible = transform === 'none' || 
                                     transform === 'matrix(1, 0, 0, 1, 0, 0)' ||
                                     transform.includes('matrix(1, 0, 0, 1, 0') ||
                                     sidebar.style.transform === 'translateX(0px)' ||
                                     sidebar.style.transform === 'translateX(0)';
                    
                    const isOpen = hasOpenClass || isVisible;
                    
                    if (isOpen) {
                        // Force show with inline styles
                        closeBtn.style.setProperty('display', 'flex', 'important');
                        closeBtn.style.setProperty('opacity', '1', 'important');
                        closeBtn.style.setProperty('visibility', 'visible', 'important');
                        closeBtn.style.setProperty('pointer-events', 'auto', 'important');
                        closeBtn.style.setProperty('position', 'fixed', 'important');
                        closeBtn.style.setProperty('right', '16px', 'important');
                        closeBtn.style.setProperty('top', '16px', 'important');
                        closeBtn.style.setProperty('z-index', '99999', 'important');
                        console.log('Close button shown');
                    } else {
                        closeBtn.style.setProperty('display', 'none', 'important');
                        closeBtn.style.setProperty('opacity', '0', 'important');
                        closeBtn.style.setProperty('visibility', 'hidden', 'important');
                        closeBtn.style.setProperty('pointer-events', 'none', 'important');
                        console.log('Close button hidden');
                    }
                }
                
                // Watch for sidebar state changes
                const observer = new MutationObserver(updateCloseButton);
                observer.observe(sidebar, {
                    attributes: true,
                    attributeFilter: ['class', 'style'],
                    childList: false,
                    subtree: false
                });
                
                // Also check periodically (fallback)
                setInterval(updateCloseButton, 100);
                
                // Initial check
                updateCloseButton();
                
                // Debug: Log button state
                console.log('Sidebar close button initialized:', {
                    sidebar: sidebar,
                    closeBtn: closeBtn,
                    sidebarHasOpen: sidebar.classList.contains('open'),
                    sidebarTransform: getComputedStyle(sidebar).transform
                });
                
                if (mobileMenuBtn) {
                    // Override mobile menu button to toggle sidebar
                    mobileMenuBtn.addEventListener('click', function(e) {
                        if (window.innerWidth <= 1024) {
                            e.preventDefault();
                            e.stopPropagation();
                            
                            // Toggle sidebar using Alpine.js if available
                            if (window.Alpine) {
                                try {
                                    const rootElement = document.querySelector('[x-data]');
                                    if (rootElement && rootElement._x_dataStack) {
                                        const alpineData = rootElement._x_dataStack[0];
                                        if (alpineData && typeof alpineData.sidebarOpen !== 'undefined') {
                                            alpineData.sidebarOpen = !alpineData.sidebarOpen;
                                            setTimeout(updateCloseButton, 50);
                                            return;
                                        }
                                    }
                                } catch (err) {
                                    console.log('Alpine.js access failed, using class toggle');
                                }
                            }
                            
                            // Fallback: toggle class directly
                            sidebar.classList.toggle('open');
                            setTimeout(updateCloseButton, 50);
                        }
                    });
                }
                
                // Close sidebar when clicking outside on mobile
                document.addEventListener('click', function(e) {
                    if (window.innerWidth <= 1024) {
                        const sidebar = document.querySelector('.sidebar');
                        const closeBtn = document.querySelector('.sidebar-close-btn');
                        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
                        
                        // Don't close if clicking on close button, mobile menu button, or inside sidebar
                        if (sidebar && 
                            !sidebar.contains(e.target) && 
                            e.target !== closeBtn && 
                            !e.target.closest('.mobile-menu-btn') &&
                            !e.target.closest('.sidebar-close-btn')) {
                            
                            // Try Alpine.js first
                            if (window.Alpine) {
                                try {
                                    const rootElement = document.querySelector('[x-data]');
                                    if (rootElement && rootElement._x_dataStack) {
                                        const alpineData = rootElement._x_dataStack[0];
                                        if (alpineData && typeof alpineData.sidebarOpen !== 'undefined') {
                                            alpineData.sidebarOpen = false;
                                            setTimeout(updateCloseButton, 50);
                                            return;
                                        }
                                    }
                                } catch (err) {
                                    // Fallback
                                }
                            }
                            
                            // Fallback: remove class
                            sidebar.classList.remove('open');
                            setTimeout(updateCloseButton, 50);
                        }
                    }
                });
            }
            
            // Initialize sidebar toggle after DOM is ready
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', initSidebarToggle);
            } else {
                initSidebarToggle();
            }
            
            // Also initialize after Alpine.js is ready
            if (window.Alpine) {
                Alpine.nextTick(() => {
                    initSidebarToggle();
                });
            } else {
                document.addEventListener('alpine:init', () => {
                    initSidebarToggle();
                });
            }

            // AI Tools Modal functionality
            const aiToolsModal = document.getElementById('aiToolsModal');
            const aiToolsBtn = document.querySelector('[data-bs-target="#aiToolsModal"]');
            
            if (aiToolsModal && aiToolsBtn) {
                // Add click event to AI tools button
                aiToolsBtn.addEventListener('click', function() {
                    console.log('AI Tools button clicked');
                });

                // Add event listeners for modal show/hide
                aiToolsModal.addEventListener('show.bs.modal', function() {
                    console.log('AI Tools modal opening');
                });

                aiToolsModal.addEventListener('hide.bs.modal', function() {
                    console.log('AI Tools modal closing');
                });

                // Add click event to modal buttons to close modal
                const modalBtns = aiToolsModal.querySelectorAll('.modal-btn');
                modalBtns.forEach(btn => {
                    btn.addEventListener('click', function() {
                        // Close modal after a short delay to allow navigation
                        setTimeout(() => {
                            const modal = bootstrap.Modal.getInstance(aiToolsModal);
                            if (modal) {
                                modal.hide();
                            }
                        }, 100);
                    });
                });
            }

            // Mobile navbar modal functionality
            const mobileNavbarModal = document.getElementById('mobileNavbarModal');
            const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
            
            if (mobileNavbarModal && mobileMenuBtn) {
                // Add click event to mobile menu button
                mobileMenuBtn.addEventListener('click', function() {
                    console.log('Mobile menu button clicked');
                });

                // Add event listeners for modal show/hide
                mobileNavbarModal.addEventListener('show.bs.modal', function() {
                    console.log('Mobile navbar modal opening');
                    document.body.style.overflow = 'hidden';
                });

                mobileNavbarModal.addEventListener('hide.bs.modal', function() {
                    console.log('Mobile navbar modal closing');
                    document.body.style.overflow = 'auto';
                });

                // Add click event to mobile nav links to close modal
                const mobileNavLinks = mobileNavbarModal.querySelectorAll('.mobile-nav-link');
                mobileNavLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        // Close modal after a short delay to allow navigation
                        setTimeout(() => {
                            const modal = bootstrap.Modal.getInstance(mobileNavbarModal);
                            if (modal) {
                                modal.hide();
                            }
                        }, 100);
                    });
                });

                // Add smooth scroll behavior for modal content
                const modalBody = mobileNavbarModal.querySelector('.mobile-navbar-body');
                if (modalBody) {
                    modalBody.style.scrollBehavior = 'smooth';
                }
            }
            
            // iOS Safari fix: Keep mobile bottom nav fixed during scroll
            function fixMobileNavForIOS() {
                const mobileNav = document.querySelector('.mobile-nav');
                if (!mobileNav) return;
                
                // Check if iOS device
                const isIOS = /iPad|iPhone|iPod/.test(navigator.userAgent) || 
                             (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
                
                // Check if mobile viewport
                const isMobile = window.innerWidth <= 768;
                
                if (isMobile) {
                    // Function to force fixed position
                    function enforceFixedPosition() {
                        const computedStyle = window.getComputedStyle(mobileNav);
                        if (computedStyle.display === 'none') return;
                        
                        // Get viewport height (accounting for iOS address bar)
                        const vh = window.innerHeight;
                        const navRect = mobileNav.getBoundingClientRect();
                        
                        // Force fixed position with inline styles using setProperty
                        try {
                            mobileNav.style.setProperty('position', 'fixed', 'important');
                            mobileNav.style.setProperty('bottom', '0', 'important');
                            mobileNav.style.setProperty('left', '0', 'important');
                            mobileNav.style.setProperty('right', '0', 'important');
                            mobileNav.style.setProperty('width', '100%', 'important');
                            mobileNav.style.setProperty('max-width', '100vw', 'important');
                            mobileNav.style.setProperty('z-index', '99999', 'important');
                            mobileNav.style.setProperty('margin', '0', 'important');
                            mobileNav.style.setProperty('top', 'auto', 'important');
                            mobileNav.style.setProperty('-webkit-transform', 'translate3d(0, 0, 0)', 'important');
                            mobileNav.style.setProperty('transform', 'translate3d(0, 0, 0)', 'important');
                        } catch (e) {
                            // Fallback for browsers that don't support setProperty with important
                            mobileNav.style.position = 'fixed';
                            mobileNav.style.bottom = '0';
                            mobileNav.style.left = '0';
                            mobileNav.style.right = '0';
                            mobileNav.style.width = '100%';
                            mobileNav.style.zIndex = '99999';
                            mobileNav.style.transform = 'translate3d(0, 0, 0)';
                            mobileNav.style.webkitTransform = 'translate3d(0, 0, 0)';
                        }
                        
                        // Verify position is correct
                        requestAnimationFrame(() => {
                            const newRect = mobileNav.getBoundingClientRect();
                            const currentVh = window.innerHeight;
                            if (Math.abs(newRect.bottom - currentVh) > 1) {
                                // Force recalculation
                                mobileNav.style.setProperty('bottom', '0', 'important');
                            }
                        });
                    }
                    
                    // Apply immediately
                    enforceFixedPosition();
                    
                    // Apply on scroll (with throttling using requestAnimationFrame)
                    let scrollRaf;
                    window.addEventListener('scroll', function() {
                        if (scrollRaf) {
                            cancelAnimationFrame(scrollRaf);
                        }
                        scrollRaf = requestAnimationFrame(enforceFixedPosition);
                    }, { passive: true });
                    
                    // Apply on resize/orientation change
                    window.addEventListener('resize', function() {
                        requestAnimationFrame(enforceFixedPosition);
                    }, { passive: true });
                    
                    window.addEventListener('orientationchange', function() {
                        setTimeout(function() {
                            requestAnimationFrame(enforceFixedPosition);
                        }, 100);
                    });
                    
                    // Periodic check (every 300ms) to ensure position is maintained on iOS
                    if (isIOS) {
                        setInterval(function() {
                            const computedStyle = window.getComputedStyle(mobileNav);
                            if (computedStyle.display !== 'none') {
                                enforceFixedPosition();
                            }
                        }, 300);
                    }
                }
            }
            
            // Initialize iOS fix
            if (document.readyState === 'loading') {
                document.addEventListener('DOMContentLoaded', fixMobileNavForIOS);
            } else {
                fixMobileNavForIOS();
            }
            
            // Also run after a delay to ensure everything is loaded
            setTimeout(fixMobileNavForIOS, 300);
            
            // Run again after Alpine.js initializes (if present)
            if (window.Alpine) {
                Alpine.nextTick(fixMobileNavForIOS);
            }
});

// Initialize Notification System
document.addEventListener('DOMContentLoaded', function() {
    console.log('Initializing notification system...');
    if (typeof NotificationSystem !== 'undefined') {
        window.notificationSystem = new NotificationSystem();
        console.log('Notification system initialized successfully');
    } else {
        console.error('NotificationSystem class not found!');
    }
});
</script>
</body>
</html>